# ­ЪЊА Synapse Communication Module API Reference

## ­Ъј» рЃЏрЃўрЃќрЃљрЃюрЃў

рЃћрЃА рЃЊрЃЮрЃЎрЃБрЃЏрЃћрЃюрЃбрЃў рЃљрЃдрЃгрЃћрЃарЃА Synapse Framework-рЃўрЃА рЃАрЃљрЃЎрЃЮрЃЏрЃБрЃюрЃўрЃЎрЃљрЃфрЃўрЃЮ рЃЏрЃЮрЃЊрЃБрЃџрЃћрЃЉрЃўрЃА рЃЏрЃўрЃћрЃа рЃЏрЃЮрЃгрЃЮрЃЊрЃћрЃЉрЃБрЃџ **рЃАрЃбрЃљрЃюрЃЊрЃљрЃарЃбрЃБрЃџ рЃАрЃћрЃарЃЋрЃўрЃАрЃўрЃА API-рЃћрЃЉрЃА**. рЃћрЃА API-рЃћрЃЉрЃў рЃ«рЃћрЃџрЃЏрЃўрЃАрЃљрЃгрЃЋрЃЊрЃЮрЃЏрЃўрЃљ `Service Locator`-рЃўрЃА рЃЏрЃћрЃерЃЋрЃћрЃЮрЃЉрЃўрЃЌ рЃЊрЃљ рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃљрЃА рЃљрЃФрЃџрЃћрЃЋрЃА рЃАрЃ«рЃЋрЃљ рЃЏрЃЮрЃЊрЃБрЃџрЃћрЃЉрЃА, рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃЮрЃю рЃЦрЃАрЃћрЃџрЃБрЃарЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃЮрЃюрЃљрЃџрЃў (WiFi, MQTT, ESP-NOW) рЃўрЃќрЃЮрЃџрЃўрЃарЃћрЃЉрЃБрЃџрЃљрЃЊ рЃЊрЃљ рЃБрЃАрЃљрЃцрЃарЃЌрЃ«рЃЮрЃЊ.

---

## ­ЪЊХ WiFi Manager Service API

**рЃАрЃћрЃарЃЋрЃўрЃАрЃўрЃА рЃбрЃўрЃърЃў:** `SYNAPSE_SERVICE_TYPE_WIFI_API`  
**рЃўрЃюрЃбрЃћрЃарЃцрЃћрЃўрЃАрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ:** `wifi_api_t` (рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃБрЃџрЃўрЃљ `wifi_interface.h`-рЃерЃў)

### рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў

- **`esp_err_t connect(const char *ssid, const char *password);`**  
    рЃљрЃЎрЃљрЃЋрЃерЃўрЃарЃћрЃЉрЃА рЃЏрЃЮрЃгрЃДрЃЮрЃЉрЃўрЃџрЃЮрЃЉрЃљрЃА рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃБрЃџ WiFi рЃЦрЃАрЃћрЃџрЃЌрЃљрЃю. рЃЌрЃБ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў рЃАрЃгрЃЮрЃарЃўрЃљ, рЃўрЃАрЃўрЃюрЃў рЃљрЃАрЃћрЃЋрЃћ рЃўрЃюрЃљрЃ«рЃћрЃЉрЃљ `Storage Manager`-рЃўрЃА рЃЏрЃћрЃерЃЋрЃћрЃЮрЃЉрЃўрЃЌ.

- **`esp_err_t disconnect(void);`**  
    рЃгрЃДрЃЋрЃћрЃбрЃА рЃЏрЃўрЃЏрЃЊрЃўрЃюрЃљрЃарЃћ WiFi рЃЎрЃљрЃЋрЃерЃўрЃарЃА.

- **`bool is_connected(void);`**  
    рЃљрЃЉрЃарЃБрЃюрЃћрЃЉрЃА `true`-рЃА, рЃЌрЃБ рЃЏрЃЮрЃгрЃДрЃЮрЃЉрЃўрЃџрЃЮрЃЉрЃљ рЃЊрЃљрЃЎрЃљрЃЋрЃерЃўрЃарЃћрЃЉрЃБрЃџрЃўрЃљ рЃЦрЃАрЃћрЃџрЃЌрЃљрЃю рЃЊрЃљ рЃљрЃЦрЃЋрЃА IP рЃЏрЃўрЃАрЃљрЃЏрЃљрЃарЃЌрЃў.

- **`esp_err_t get_ip_info(esp_netif_ip_info_t *ip_info);`**  
    рЃљрЃЉрЃарЃБрЃюрЃћрЃЉрЃА рЃЏрЃўрЃЏрЃЊрЃўрЃюрЃљрЃарЃћ IP рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљрЃА.

### ­ЪњА WiFi API-рЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў

```c
#include "service_locator.h"
#include "wifi_interface.h" // рЃБрЃюрЃЊрЃљ рЃерЃћрЃўрЃЦрЃЏрЃюрЃљрЃА interfaces рЃЊрЃўрЃарЃћрЃЦрЃбрЃЮрЃарЃўрЃљрЃерЃў

void check_wifi_status() {
    service_handle_t wifi_handle = synapse_service_get("main_wifi");
    if (wifi_handle) {
        wifi_api_t *wifi_api = (wifi_api_t *)wifi_handle;
        
        if (wifi_api->is_connected()) {
            ESP_LOGI(TAG, "WiFi is connected.");
        } else {
            ESP_LOGW(TAG, "WiFi is disconnected.");
        }
    }
}
```

---

## РўЂ№ИЈ MQTT Client Service API

**рЃАрЃћрЃарЃЋрЃўрЃАрЃўрЃА рЃбрЃўрЃърЃў:** `SYNAPSE_SERVICE_TYPE_MQTT_API`  
**рЃўрЃюрЃбрЃћрЃарЃцрЃћрЃўрЃАрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ:** `mqtt_api_t` (рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃБрЃџрЃўрЃљ `mqtt_interface.h`-рЃерЃў)

### рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў

- **`esp_err_t connect(void);`**  
    рЃўрЃгрЃДрЃћрЃЉрЃА рЃЎрЃљрЃЋрЃерЃўрЃарЃА рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљрЃерЃў рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃБрЃџ MQTT рЃЉрЃарЃЮрЃЎрЃћрЃарЃЌрЃљрЃю.

- **`esp_err_t publish(const char *topic, const char *data, int qos, bool retain);`**  
    рЃљрЃЦрЃЋрЃћрЃДрЃюрЃћрЃЉрЃА рЃерЃћрЃбрЃДрЃЮрЃЉрЃўрЃюрЃћрЃЉрЃљрЃА рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃБрЃџ рЃЌрЃћрЃЏрЃљрЃќрЃћ (topic).

- **`esp_err_t subscribe(const char *topic, int qos);`**  
    рЃўрЃгрЃћрЃарЃА рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃБрЃџ рЃЌрЃћрЃЏрЃљрЃА. рЃЏрЃўрЃдрЃћрЃЉрЃБрЃџрЃў рЃерЃћрЃбрЃДрЃЮрЃЉрЃўрЃюрЃћрЃЉрЃћрЃЉрЃў рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃЊрЃћрЃЉрЃљ рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃерЃўрЃЊрЃљ рЃџрЃЮрЃњрЃўрЃЎрЃўрЃЌ.

- **`bool is_connected(void);`**  
    рЃљрЃЉрЃарЃБрЃюрЃћрЃЉрЃА `true`-рЃА, рЃЌрЃБ MQTT рЃЎрЃџрЃўрЃћрЃюрЃбрЃў рЃЊрЃљрЃЎрЃљрЃЋрЃерЃўрЃарЃћрЃЉрЃБрЃџрЃўрЃљ рЃЉрЃарЃЮрЃЎрЃћрЃарЃЌрЃљрЃю.

### ­ЪњА MQTT API-рЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў

```c
#include "service_locator.h"
#include "mqtt_interface.h"

void publish_sensor_data(float temperature) {
    service_handle_t mqtt_handle = synapse_service_get("main_mqtt_broker");
    if (mqtt_handle) {
        mqtt_api_t *mqtt_api = (mqtt_api_t *)mqtt_handle;
        
        if (mqtt_api->is_connected()) {
            char payload[32];
            snprintf(payload, sizeof(payload), "{\"temp\": %.2f}", temperature);
            mqtt_api->publish("/sensors/temperature", payload, 1, false);
        }
    }
}
```

---

## РџА ESP-NOW Service API

**рЃАрЃћрЃарЃЋрЃўрЃАрЃўрЃА рЃбрЃўрЃърЃў:** `SYNAPSE_SERVICE_TYPE_ESPNOW_API` (рЃБрЃюрЃЊрЃљ рЃЊрЃљрЃћрЃЏрЃљрЃбрЃЮрЃА `service_types.h`-рЃерЃў)  
**рЃўрЃюрЃбрЃћрЃарЃцрЃћрЃўрЃАрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ:** `espnow_api_t` (рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃБрЃџрЃўрЃљ `espnow_interface.h`-рЃерЃў)

### рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў

- **`esp_err_t add_peer(const uint8_t *mac_addr, uint8_t channel);`**  
    рЃљрЃЏрЃљрЃбрЃћрЃЉрЃА рЃљрЃ«рЃљрЃџ ESP-NOW рЃЏрЃЮрЃгрЃДрЃЮрЃЉрЃўрЃџрЃЮрЃЉрЃљрЃА (peer) рЃАрЃљрЃюрЃЊрЃЮ рЃАрЃўрЃљрЃерЃў.

- **`esp_err_t send_data(const uint8_t *mac_addr, const uint8_t *data, size_t len);`**  
    рЃљрЃњрЃќрЃљрЃЋрЃюрЃўрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃА рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃБрЃџ MAC рЃЏрЃўрЃАрЃљрЃЏрЃљрЃарЃЌрЃќрЃћ.

- **`esp_err_t register_receive_callback(espnow_recv_cb_t callback);`**  
    рЃљрЃарЃћрЃњрЃўрЃАрЃбрЃарЃўрЃарЃћрЃЉрЃА callback рЃцрЃБрЃюрЃЦрЃфрЃўрЃљрЃА, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃњрЃљрЃЏрЃЮрЃўрЃФрЃљрЃ«рЃћрЃЉрЃљ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃЏрЃўрЃдрЃћрЃЉрЃўрЃАрЃљрЃА.

---

## ­ЪЊю Naming & Structure рЃЎрЃЮрЃюрЃЋрЃћрЃюрЃфрЃўрЃћрЃЉрЃў

- рЃДрЃЋрЃћрЃџрЃљ рЃАрЃљрЃЎрЃЮрЃЏрЃБрЃюрЃўрЃЎрЃљрЃфрЃўрЃЮ рЃАрЃћрЃарЃЋрЃўрЃАрЃўрЃА API рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ рЃБрЃюрЃЊрЃљ рЃўрЃДрЃЮрЃА рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃБрЃџрЃў `components/interfaces/include` рЃЊрЃўрЃарЃћрЃЦрЃбрЃЮрЃарЃўрЃљрЃерЃў рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃА `*_interface.h` рЃцрЃљрЃўрЃџрЃерЃў.
- рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃўрЃА рЃАрЃљрЃ«рЃћрЃџрЃћрЃЉрЃў рЃБрЃюрЃЊрЃљ рЃЏрЃўрЃ░рЃДрЃЋрЃћрЃЉрЃЮрЃЊрЃћрЃА [function_naming.md](../convention/function_naming.md) рЃгрЃћрЃАрЃћрЃЉрЃА.

---

рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃЊрЃћрЃбрЃљрЃџрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА рЃўрЃ«рЃўрЃџрЃћрЃЌ [core_api.md](core_api.md) рЃЊрЃљ рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃАрЃў рЃЏрЃЮрЃЊрЃБрЃџрЃћрЃЉрЃўрЃА `README.md` рЃцрЃљрЃўрЃџрЃћрЃЉрЃў.
