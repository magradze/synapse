# ğŸ”˜ áƒ›áƒáƒ“áƒ£áƒšáƒ˜: `rotary_encoder_input`

**ğŸ—‚ï¸ áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ:** `drivers`  
**âœ’ï¸ áƒáƒ•áƒ¢áƒáƒ áƒ˜:** Synapse Framework Team  
**ğŸ”– áƒ•áƒ”áƒ áƒ¡áƒ˜áƒ:** 3.0.0

## 1. ğŸ“œ áƒ›áƒ˜áƒ›áƒáƒ®áƒ˜áƒšáƒ•áƒ

`rotary_encoder_input` áƒáƒ áƒ˜áƒ¡ Synapse Framework-áƒ˜áƒ¡ **áƒ£áƒœáƒ˜áƒ•áƒ”áƒ áƒ¡áƒáƒšáƒ£áƒ áƒ˜, áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒ¨áƒ”áƒ¢áƒáƒœáƒ˜áƒ¡ (User Input) áƒ›áƒáƒ“áƒ£áƒšáƒ˜**, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒ¨áƒ”áƒ¥áƒ›áƒœáƒ˜áƒšáƒ˜áƒ áƒ›áƒ‘áƒ áƒ£áƒœáƒáƒ•áƒ˜ áƒ”áƒœáƒ™áƒáƒ“áƒ”áƒ áƒ”áƒ‘áƒ˜áƒ¡ (Rotary Encoders) áƒ“áƒáƒ¡áƒáƒ›áƒ£áƒ¨áƒáƒ•áƒ”áƒ‘áƒšáƒáƒ“. áƒ›áƒ˜áƒ¡áƒ˜ áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜ áƒáƒ›áƒáƒªáƒáƒœáƒáƒ, áƒáƒ˜áƒ¦áƒáƒ¡ áƒ“áƒáƒ‘áƒáƒšáƒ˜ áƒ“áƒáƒœáƒ˜áƒ¡, áƒ™áƒáƒ›áƒáƒšáƒ”áƒ¥áƒ¡áƒ£áƒ áƒ˜ áƒáƒáƒáƒ áƒáƒ¢áƒ£áƒ áƒ£áƒšáƒ˜ áƒ¡áƒ˜áƒ’áƒœáƒáƒšáƒ”áƒ‘áƒ˜ (áƒ‘áƒ áƒ£áƒœáƒ•áƒ áƒ“áƒ áƒ“áƒáƒ­áƒ”áƒ áƒ) áƒ“áƒ áƒ’áƒáƒ“áƒáƒ—áƒáƒ áƒ’áƒ›áƒœáƒáƒ¡ áƒ˜áƒ¡áƒ˜áƒœáƒ˜ áƒ›áƒáƒ¦áƒáƒšáƒ˜ áƒ“áƒáƒœáƒ˜áƒ¡, áƒ¡áƒ¢áƒáƒœáƒ“áƒáƒ áƒ¢áƒ£áƒš, áƒ¤áƒ áƒ”áƒ˜áƒ›áƒ•áƒáƒ áƒ¥áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡ áƒ’áƒáƒ¡áƒáƒ’áƒ”áƒ‘ áƒ˜áƒ•áƒ”áƒœáƒ—áƒ”áƒ‘áƒáƒ“.

áƒ›áƒáƒ“áƒ£áƒšáƒ˜ áƒ¡áƒ áƒ£áƒšáƒáƒ“ áƒáƒ‘áƒ¡áƒ¢áƒ áƒáƒ’áƒ˜áƒ áƒ”áƒ‘áƒ¡ áƒáƒáƒáƒ áƒáƒ¢áƒ£áƒ áƒ£áƒš áƒ“áƒ”áƒ¢áƒáƒšáƒ”áƒ‘áƒ¡ áƒ“áƒ `Event Bus`-áƒ–áƒ” áƒáƒ¥áƒ•áƒ”áƒ§áƒœáƒ”áƒ‘áƒ¡ **áƒ–áƒ£áƒ¡áƒ¢áƒáƒ“ áƒ˜áƒ’áƒ˜áƒ•áƒ”** `SYNAPSE_EVENT_BUTTON_PRESSED` áƒ˜áƒ•áƒ”áƒœáƒ—áƒ”áƒ‘áƒ¡, áƒ áƒáƒ¡áƒáƒª `button_input` áƒ›áƒáƒ“áƒ£áƒšáƒ˜. áƒ”áƒ¡ áƒáƒ áƒ¥áƒ˜áƒ¢áƒ”áƒ¥áƒ¢áƒ£áƒ áƒ£áƒšáƒ˜ áƒ’áƒáƒ“áƒáƒ¬áƒ§áƒ•áƒ”áƒ¢áƒ˜áƒšáƒ”áƒ‘áƒ áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ”áƒ‘áƒáƒ¡ áƒáƒ«áƒšáƒ”áƒ•áƒ¡ `ui_manager`-áƒ¡ áƒ“áƒ áƒ¡áƒ®áƒ•áƒ áƒ›áƒáƒ“áƒ£áƒšáƒ”áƒ‘áƒ¡, áƒ£áƒ›áƒ¢áƒ™áƒ˜áƒ•áƒœáƒ”áƒ£áƒšáƒáƒ“ áƒ“áƒ áƒ§áƒáƒ•áƒ”áƒšáƒ’áƒ•áƒáƒ áƒ˜ áƒªáƒ•áƒšáƒ˜áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ’áƒáƒ áƒ”áƒ¨áƒ” áƒ˜áƒ›áƒ£áƒ¨áƒáƒáƒœ áƒ”áƒœáƒ™áƒáƒ“áƒ”áƒ áƒ—áƒáƒœ, áƒ—áƒ˜áƒ—áƒ¥áƒáƒ¡ áƒ˜áƒ¡ áƒ©áƒ•áƒ”áƒ£áƒšáƒ”áƒ‘áƒ áƒ˜áƒ•áƒ˜ `UP`/`DOWN`/`OK` áƒ¦áƒ˜áƒšáƒáƒ™áƒ”áƒ‘áƒ˜áƒ¡ áƒœáƒáƒ™áƒ áƒ”áƒ‘áƒ˜ áƒ˜áƒ§áƒáƒ¡.

## 2. ğŸ›ï¸ áƒáƒ áƒ¥áƒ˜áƒ¢áƒ”áƒ¥áƒ¢áƒ£áƒ áƒ£áƒšáƒ˜ áƒáƒ áƒ˜áƒœáƒªáƒ˜áƒáƒ”áƒ‘áƒ˜

- **áƒ áƒ”áƒ¡áƒ£áƒ áƒ¡áƒ”áƒ‘áƒ˜áƒ¡ áƒáƒáƒ¢áƒ˜áƒ›áƒ˜áƒ–áƒáƒªáƒ˜áƒ:** áƒ›áƒáƒ“áƒ£áƒšáƒ˜ **áƒáƒ  áƒ¥áƒ›áƒœáƒ˜áƒ¡ áƒ¡áƒáƒ™áƒ£áƒ—áƒáƒ  áƒ¢áƒáƒ¡áƒ™áƒ¡**. áƒáƒ›áƒ˜áƒ¡ áƒœáƒáƒªáƒ•áƒšáƒáƒ“, áƒ˜áƒ¡ áƒ—áƒáƒ•áƒ˜áƒ¡ áƒáƒ”áƒ áƒ˜áƒáƒ“áƒ£áƒš áƒ¬áƒáƒ™áƒ˜áƒ—áƒ®áƒ•áƒ˜áƒ¡ áƒšáƒáƒ’áƒ˜áƒ™áƒáƒ¡ áƒáƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒ˜áƒ áƒ”áƒ‘áƒ¡ `core`-áƒ˜áƒ¡ **`Task Pool Manager`**-áƒ¨áƒ˜, áƒ áƒáƒ’áƒáƒ áƒª "áƒ“áƒáƒ•áƒáƒšáƒ”áƒ‘áƒ" (`Job`). áƒ”áƒ¡ áƒ›áƒ˜áƒ“áƒ’áƒáƒ›áƒ áƒ–áƒáƒ’áƒáƒ•áƒ¡ ~3KB áƒáƒáƒ”áƒ áƒáƒ¢áƒ˜áƒ£áƒš áƒ›áƒ”áƒ®áƒ¡áƒ˜áƒ”áƒ áƒ”áƒ‘áƒáƒ¡ áƒ“áƒ áƒáƒ›áƒªáƒ˜áƒ áƒ”áƒ‘áƒ¡ áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ˜áƒ¡ áƒ¡áƒáƒ”áƒ áƒ—áƒ áƒ“áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒáƒ¡.
- **áƒáƒ áƒ›áƒáƒ’áƒ˜ áƒ áƒ”áƒŸáƒ˜áƒ›áƒ˜ (Dual Mode):** âš™ï¸ áƒ›áƒáƒ“áƒ£áƒšáƒ¡ áƒ¨áƒ”áƒ£áƒ«áƒšáƒ˜áƒ áƒ˜áƒ›áƒ£áƒ¨áƒáƒáƒ¡ áƒáƒ , áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ˜áƒ— áƒ›áƒáƒ áƒ—áƒ•áƒáƒ“ áƒ áƒ”áƒŸáƒ˜áƒ›áƒ¨áƒ˜:
  1. **`GPIO` áƒ áƒ”áƒŸáƒ˜áƒ›áƒ˜:** áƒ”áƒœáƒ™áƒáƒ“áƒ”áƒ áƒ˜ áƒ›áƒ˜áƒ”áƒ áƒ—áƒ”áƒ‘áƒ£áƒšáƒ˜áƒ áƒáƒ˜áƒ áƒ“áƒáƒáƒ˜áƒ  ESP32-áƒ˜áƒ¡ GPIO áƒáƒ˜áƒœáƒ”áƒ‘áƒ–áƒ”.
  2. **`Expander` áƒ áƒ”áƒŸáƒ˜áƒ›áƒ˜:** áƒ”áƒœáƒ™áƒáƒ“áƒ”áƒ áƒ˜ áƒ›áƒ˜áƒ”áƒ áƒ—áƒ”áƒ‘áƒ£áƒšáƒ˜áƒ `MCP23017` I/O áƒ’áƒáƒ›áƒ¤áƒáƒ áƒ—áƒáƒ”áƒ‘áƒ”áƒšáƒ–áƒ”.
- **Event Producer:** ğŸ“¢ áƒ›áƒáƒ“áƒ£áƒšáƒ˜ áƒáƒ áƒ˜áƒ¡ áƒ¡áƒ£áƒ¤áƒ—áƒ "áƒ˜áƒ•áƒ”áƒœáƒ—áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ¬áƒáƒ áƒ›áƒáƒ”áƒ‘áƒ”áƒšáƒ˜". áƒ›áƒ˜áƒ¡áƒ˜ áƒ”áƒ áƒ—áƒáƒ“áƒ”áƒ áƒ—áƒ˜ áƒ’áƒáƒ›áƒáƒ›áƒáƒ•áƒáƒšáƒ˜ áƒáƒ áƒáƒ“áƒ£áƒ¥áƒ¢áƒ˜ áƒáƒ áƒ˜áƒ¡ `SYNAPSE_EVENT_BUTTON_PRESSED` áƒ˜áƒ•áƒ”áƒœáƒ—áƒ˜.
- **áƒ›áƒ“áƒ’áƒáƒ›áƒáƒ áƒ”áƒáƒ‘áƒ˜áƒ¡ áƒ›áƒáƒœáƒ¥áƒáƒœáƒ (State Machine):** ğŸ§  áƒ‘áƒ áƒ£áƒœáƒ•áƒ˜áƒ¡ áƒ›áƒ˜áƒ›áƒáƒ áƒ—áƒ£áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ–áƒ£áƒ¡áƒ¢áƒáƒ“ áƒ“áƒáƒ¡áƒáƒ“áƒ’áƒ”áƒœáƒáƒ“, áƒ›áƒáƒ“áƒ£áƒšáƒ˜ áƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ¡ áƒ¡áƒ áƒ£áƒš áƒ™áƒ•áƒáƒ“áƒ áƒáƒ¢áƒ£áƒ áƒ£áƒš áƒ“áƒ”áƒ™áƒáƒ“áƒ˜áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒáƒšáƒ’áƒáƒ áƒ˜áƒ—áƒ›áƒ¡, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒ›áƒ“áƒ’áƒ áƒáƒ“áƒ˜áƒ áƒ•áƒ˜áƒ‘áƒ áƒáƒªáƒ˜áƒ˜áƒ¡áƒ áƒ“áƒ "áƒ¬áƒ áƒ˜áƒáƒ˜áƒœáƒ˜áƒ¡" áƒ›áƒ˜áƒ›áƒáƒ áƒ—.
- **Debouncing:** ğŸ›¡ï¸ áƒ”áƒœáƒ™áƒáƒ“áƒ”áƒ áƒ˜áƒ¡ áƒ¦áƒ˜áƒšáƒáƒ™áƒ¡ áƒáƒ¥áƒ•áƒ¡ áƒ©áƒáƒ¨áƒ”áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ¡áƒáƒ˜áƒ›áƒ”áƒ“áƒ, áƒ“áƒ áƒáƒ–áƒ” áƒ“áƒáƒ¤áƒ£áƒ«áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ Debouncing áƒ›áƒ”áƒ¥áƒáƒœáƒ˜áƒ–áƒ›áƒ˜.
- **áƒ áƒ”áƒ¡áƒ£áƒ áƒ¡áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ áƒ—áƒ•áƒ:** `GPIO` áƒ áƒ”áƒŸáƒ˜áƒ›áƒ¨áƒ˜, áƒ›áƒáƒ“áƒ£áƒšáƒ˜ áƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ¡ `Resource Manager`-áƒ¡ áƒ¨áƒ”áƒ¡áƒáƒ‘áƒáƒ›áƒ˜áƒ¡áƒ˜ áƒáƒ˜áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ”áƒ¥áƒ¡áƒ™áƒšáƒ£áƒ–áƒ˜áƒ£áƒ áƒáƒ“ áƒ“áƒáƒ¡áƒáƒ™áƒáƒ•áƒ”áƒ‘áƒšáƒáƒ“.

## 3. âš™ï¸ áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ (`config.json`)

áƒ›áƒáƒ“áƒ£áƒšáƒ˜áƒ¡ áƒ¥áƒªáƒ”áƒ•áƒ áƒ“áƒ áƒ áƒ”áƒŸáƒ˜áƒ›áƒ˜ áƒ¡áƒ áƒ£áƒšáƒáƒ“ áƒ˜áƒ›áƒáƒ áƒ—áƒ”áƒ‘áƒ `config.json` áƒ¤áƒáƒ˜áƒšáƒ˜áƒ“áƒáƒœ.

### 3.1. áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ `GPIO` áƒ áƒ”áƒŸáƒ˜áƒ›áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡

```json
[
  {
    "type": "rotary_encoder_input",
    "enabled": true,
    "config": {
      "instance_name": "main_rotary_encoder",
      "control_type": "gpio",
      "pin_a": 32,
      "pin_b": 33,
      "pin_sw": 25,
      "button_name": "OK",
      "active_level": 0,
      "polling_interval_ms": 20
    }
  }
]
```

### 3.2. áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ `Expander` áƒ áƒ”áƒŸáƒ˜áƒ›áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡

```json
[
  {
    "type": "rotary_encoder_input",
    "enabled": true,
    "config": {
      "instance_name": "main_rotary_encoder",
      "control_type": "expander",
      "expander_service": "main_io_expander",
      "pin_a": 10,
      "pin_b": 11,
      "pin_sw": 12,
      "button_name": "OK",
      "active_level": 0,
      "polling_interval_ms": 20
    }
  }
]
```

### 3.3. áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ˜áƒ¡ áƒáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ˜

| áƒáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ˜ | áƒ¢áƒ˜áƒáƒ˜ | áƒáƒ¦áƒ¬áƒ”áƒ áƒ | áƒ¡áƒáƒ•áƒáƒšáƒ“áƒ”áƒ‘áƒ£áƒšáƒ | Default |
| :--- | :--- | :--- | :---: | :--- |
| `instance_name` | áƒ¡áƒ¢áƒ áƒ˜áƒ¥áƒáƒœáƒ˜ | áƒ›áƒáƒ“áƒ£áƒšáƒ˜áƒ¡ áƒ£áƒœáƒ˜áƒ™áƒáƒšáƒ£áƒ áƒ˜ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜. | âœ… | - |
| `control_type` | áƒ¡áƒ¢áƒ áƒ˜áƒ¥áƒáƒœáƒ˜ | áƒ›áƒ£áƒ¨áƒáƒáƒ‘áƒ˜áƒ¡ áƒ áƒ”áƒŸáƒ˜áƒ›áƒ˜: `"gpio"` áƒáƒœ `"expander"`. | âŒ | `"gpio"` |
| `expander_service` | áƒ¡áƒ¢áƒ áƒ˜áƒ¥áƒáƒœáƒ˜ | áƒ˜áƒ› `mcp23017_io_expander` áƒ¡áƒ”áƒ áƒ•áƒ˜áƒ¡áƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒ£áƒœáƒ“áƒ áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒáƒ¡. | `expander` áƒ áƒ”áƒŸáƒ˜áƒ›áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡ |
| `pin_a` | áƒ áƒ˜áƒªáƒ®áƒ•áƒ˜ | áƒ”áƒœáƒ™áƒáƒ“áƒ”áƒ áƒ˜áƒ¡ `A` (CLK) áƒáƒ˜áƒœáƒ˜áƒ¡ áƒœáƒáƒ›áƒ”áƒ áƒ˜. | âœ… | - |
| `pin_b` | áƒ áƒ˜áƒªáƒ®áƒ•áƒ˜ | áƒ”áƒœáƒ™áƒáƒ“áƒ”áƒ áƒ˜áƒ¡ `B` (DT) áƒáƒ˜áƒœáƒ˜áƒ¡ áƒœáƒáƒ›áƒ”áƒ áƒ˜. | âœ… | - |
| `pin_sw` | áƒ áƒ˜áƒªáƒ®áƒ•áƒ˜ | áƒ”áƒœáƒ™áƒáƒ“áƒ”áƒ áƒ˜áƒ¡ áƒ¦áƒ˜áƒšáƒáƒ™áƒ˜áƒ¡ (`SW`) áƒáƒ˜áƒœáƒ˜áƒ¡ áƒœáƒáƒ›áƒ”áƒ áƒ˜. | âœ… | - |
| `button_name` | áƒ¡áƒ¢áƒ áƒ˜áƒ¥áƒáƒœáƒ˜ | áƒ¡áƒáƒ®áƒ”áƒšáƒ˜, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒ’áƒáƒ˜áƒ’áƒ–áƒáƒ•áƒœáƒ”áƒ‘áƒ áƒ¦áƒ˜áƒšáƒáƒ™áƒ–áƒ” áƒ“áƒáƒ­áƒ”áƒ áƒ˜áƒ¡áƒáƒ¡. | âŒ | `"OK"` |
| `active_level` | áƒ áƒ˜áƒªáƒ®áƒ•áƒ˜ | áƒšáƒáƒ’áƒ˜áƒ™áƒ£áƒ áƒ˜ áƒ“áƒáƒœáƒ”, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒ“áƒáƒ­áƒ”áƒ áƒ˜áƒš áƒ›áƒ“áƒ’áƒáƒ›áƒáƒ áƒ”áƒáƒ‘áƒáƒ“ áƒ˜áƒ—áƒ•áƒšáƒ”áƒ‘áƒ (`0`=LOW, `1`=HIGH). | âŒ | `0` |
| `polling_interval_ms` | áƒ áƒ˜áƒªáƒ®áƒ•áƒ˜ | áƒáƒ˜áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ¬áƒáƒ™áƒ˜áƒ—áƒ®áƒ•áƒ˜áƒ¡ áƒ˜áƒœáƒ¢áƒ”áƒ áƒ•áƒáƒšáƒ˜ áƒ›áƒ˜áƒšáƒ˜áƒ¬áƒáƒ›áƒ”áƒ‘áƒ¨áƒ˜. | âŒ | `20` (Kconfig-áƒ˜áƒ“áƒáƒœ) |

## 4. ğŸ“¢ áƒ’áƒáƒ›áƒáƒ¥áƒ•áƒ”áƒ§áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ˜áƒ•áƒ”áƒœáƒ—áƒ”áƒ‘áƒ˜

áƒ›áƒáƒ“áƒ£áƒšáƒ˜ áƒáƒ¥áƒ•áƒ”áƒ§áƒœáƒ”áƒ‘áƒ¡ áƒ›áƒ®áƒáƒšáƒáƒ“ áƒ”áƒ áƒ—, áƒ¡áƒ¢áƒáƒœáƒ“áƒáƒ áƒ¢áƒ£áƒš áƒ˜áƒ•áƒ”áƒœáƒ—áƒ¡, áƒ›áƒáƒ’áƒ áƒáƒ› áƒ’áƒáƒœáƒ¡áƒ®áƒ•áƒáƒ•áƒ”áƒ‘áƒ£áƒšáƒ˜ `payload`-áƒ˜áƒ—, áƒ áƒáƒª áƒ£áƒ–áƒ áƒ£áƒœáƒ•áƒ”áƒšáƒ§áƒáƒ¤áƒ¡ `ui_manager`-áƒ—áƒáƒœ áƒ¡áƒ áƒ£áƒš áƒ—áƒáƒ•áƒ¡áƒ”áƒ‘áƒáƒ“áƒáƒ‘áƒáƒ¡.

| áƒ¤áƒ˜áƒ–áƒ˜áƒ™áƒ£áƒ áƒ˜ áƒ›áƒáƒ¥áƒ›áƒ”áƒ“áƒ”áƒ‘áƒ | áƒ˜áƒ•áƒ”áƒœáƒ—áƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜ | Payload (`button_name`) |
| :--- | :--- | :--- |
| **áƒ‘áƒ áƒ£áƒœáƒ•áƒ áƒ¡áƒáƒáƒ—áƒ˜áƒ¡ áƒ˜áƒ¡áƒ áƒ˜áƒ¡ áƒ›áƒ˜áƒ›áƒáƒ áƒ—áƒ£áƒšáƒ”áƒ‘áƒ˜áƒ— (CW)** | `SYNAPSE_EVENT_BUTTON_PRESSED` | `"DOWN"` |
| **áƒ‘áƒ áƒ£áƒœáƒ•áƒ áƒ¡áƒáƒáƒ—áƒ˜áƒ¡ áƒ˜áƒ¡áƒ áƒ˜áƒ¡ áƒ¡áƒáƒ¬áƒ˜áƒœáƒáƒáƒ¦áƒ›áƒ“áƒ”áƒ’áƒáƒ“ (CCW)** | `SYNAPSE_EVENT_BUTTON_PRESSED` | `"UP"` |
| **áƒ¦áƒ˜áƒšáƒáƒ™áƒ–áƒ” áƒ“áƒáƒ­áƒ”áƒ áƒ** | `SYNAPSE_EVENT_BUTTON_PRESSED` | `"OK"` (áƒáƒœ áƒ áƒáƒª áƒ›áƒ˜áƒ—áƒ˜áƒ—áƒ”áƒ‘áƒ£áƒšáƒ˜áƒ `button_name`-áƒ¨áƒ˜) |

**Payload-áƒ˜áƒ¡ áƒ¡áƒ¢áƒ áƒ£áƒ¥áƒ¢áƒ£áƒ áƒ:**

```c
// synapse_button_payload_t payload;
// snprintf(payload.button_name, sizeof(payload.button_name), "UP");
```

## 5. ğŸ”Œ áƒ›áƒ˜áƒ”áƒ áƒ—áƒ”áƒ‘áƒ˜áƒ¡ áƒ¡áƒ¥áƒ”áƒ›áƒ

áƒ”áƒœáƒ™áƒáƒ“áƒ”áƒ áƒ˜áƒ¡ áƒáƒ˜áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ áƒ™áƒ˜áƒ áƒ”áƒ‘áƒ (`S1`, `S2`, `KEY`) áƒáƒ˜áƒ áƒ“áƒáƒáƒ˜áƒ  áƒ¨áƒ”áƒ”áƒ¡áƒáƒ‘áƒáƒ›áƒ”áƒ‘áƒ áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ˜áƒ¡ áƒáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ¡.

- **`S1`** (áƒáƒœ **CLK**) â†”ï¸ **`pin_a`**
- **`S2`** (áƒáƒœ **DT**) â†”ï¸ **`pin_b`**
- **`KEY`** (áƒáƒœ **SW**) â†”ï¸ **`pin_sw`**

áƒáƒ áƒ˜áƒ•áƒ” áƒ áƒ”áƒŸáƒ˜áƒ›áƒ¨áƒ˜, `active_level: 0` áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡, áƒ¦áƒ˜áƒšáƒáƒ™áƒ˜ áƒ“áƒ áƒ”áƒœáƒ™áƒáƒ“áƒ”áƒ áƒ˜áƒ¡ áƒ’áƒáƒ›áƒáƒ›áƒáƒ•áƒáƒšáƒ˜ áƒáƒ˜áƒœáƒ”áƒ‘áƒ˜ áƒ£áƒœáƒ“áƒ áƒ¨áƒ”áƒ”áƒ áƒ—áƒ“áƒ”áƒ¡ **áƒáƒ˜áƒœáƒ¡áƒ** áƒ“áƒ **GND**-áƒ¡ áƒ¨áƒáƒ áƒ˜áƒ¡. áƒ›áƒáƒ“áƒ£áƒšáƒ˜ áƒáƒ•áƒ¢áƒáƒ›áƒáƒ¢áƒ£áƒ áƒáƒ“ áƒ áƒ—áƒáƒ•áƒ¡ áƒ¨áƒ˜áƒ“áƒ pull-up áƒ áƒ”áƒ–áƒ˜áƒ¡áƒ¢áƒáƒ áƒ”áƒ‘áƒ¡.

**áƒ§áƒ£áƒ áƒáƒ“áƒ¦áƒ”áƒ‘áƒ:** ESP32-áƒ˜áƒ¡ áƒ–áƒáƒ’áƒ˜áƒ”áƒ áƒ— áƒáƒ˜áƒœáƒ¡ (áƒ›áƒáƒ’., GPIO 34, 35) áƒáƒ  áƒ’áƒáƒáƒ©áƒœáƒ˜áƒ áƒ¨áƒ˜áƒ“áƒ pull-up áƒ áƒ”áƒ–áƒ˜áƒ¡áƒ¢áƒáƒ áƒ”áƒ‘áƒ˜. áƒáƒ› áƒáƒ˜áƒœáƒ”áƒ‘áƒ˜áƒ¡ `GPIO` áƒ áƒ”áƒŸáƒ˜áƒ›áƒ¨áƒ˜ áƒ’áƒáƒ›áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒ˜áƒ¡áƒáƒ¡, áƒáƒ£áƒªáƒ˜áƒšáƒ”áƒ‘áƒ”áƒšáƒ˜áƒ **áƒ’áƒáƒ áƒ” 10kÎ© Pull-up áƒ áƒ”áƒ–áƒ˜áƒ¡áƒ¢áƒáƒ áƒ˜áƒ¡** áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ.

## 6. ğŸ’¡ áƒ’áƒáƒ›áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜ (`ui_manager`-áƒ—áƒáƒœ)

áƒáƒ› áƒ›áƒáƒ“áƒ£áƒšáƒ˜áƒ¡ áƒ’áƒáƒ›áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ¡áƒ˜áƒšáƒáƒ›áƒáƒ–áƒ” áƒ˜áƒ¡áƒáƒ, áƒ áƒáƒ› **`ui_manager`-áƒ˜áƒ¡ áƒ™áƒáƒ“áƒ¨áƒ˜ áƒáƒ áƒáƒœáƒáƒ˜áƒ áƒ˜ áƒªáƒ•áƒšáƒ˜áƒšáƒ”áƒ‘áƒ áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒ¡áƒáƒ­áƒ˜áƒ áƒ!**

`ui_manager`-áƒ˜áƒ¡ áƒ˜áƒ•áƒ”áƒœáƒ—áƒ”áƒ‘áƒ˜áƒ¡ áƒ“áƒáƒ›áƒ›áƒ£áƒ¨áƒáƒ•áƒ”áƒ‘áƒ”áƒšáƒ˜ (`ui_events.c`) áƒ£áƒ™áƒ•áƒ” áƒ£áƒ¡áƒ›áƒ”áƒœáƒ¡ `SYNAPSE_EVENT_BUTTON_PRESSED` áƒ˜áƒ•áƒ”áƒœáƒ—áƒ¡ áƒ“áƒ áƒáƒ›áƒ£áƒ¨áƒáƒ•áƒ”áƒ‘áƒ¡ `"UP"`, `"DOWN"` áƒ“áƒ `"OK"` `payload`-áƒ”áƒ‘áƒ¡.

```c
// áƒœáƒáƒ¬áƒ§áƒ•áƒ”áƒ¢áƒ˜ ui_events.c-áƒ“áƒáƒœ (áƒáƒ  áƒ¡áƒáƒ­áƒ˜áƒ áƒáƒ”áƒ‘áƒ¡ áƒªáƒ•áƒšáƒ˜áƒšáƒ”áƒ‘áƒáƒ¡)
void ui_events_handle(module_t *self, const char *event_name, void *event_data)
{
    // ...
    if (strcmp(event_name, SYNAPSE_EVENT_BUTTON_PRESSED) == 0)
    {
        // ...
        const char *button_name = ((synapse_button_payload_t *)wrapper->payload)->button_name;

        // áƒ”áƒ¡ áƒšáƒáƒ’áƒ˜áƒ™áƒ áƒ˜áƒ›áƒ£áƒ¨áƒáƒ•áƒ”áƒ‘áƒ¡ áƒ áƒáƒ’áƒáƒ áƒª button_input-áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡, áƒ˜áƒ¡áƒ” rotary_encoder_input-áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡!
        if (private_data->current_state == UI_STATE_HOME) {
            if (strcmp(button_name, "OK") == 0) {
                // ... áƒ’áƒáƒ“áƒáƒ“áƒ˜ áƒ›áƒ”áƒœáƒ˜áƒ£áƒ¨áƒ˜ ...
            }
        } else {
            // ui_menu_handle_navigation áƒ’áƒáƒ›áƒáƒ˜áƒ«áƒáƒ®áƒ”áƒ‘áƒ¡ áƒ¨áƒ”áƒ¡áƒáƒ‘áƒáƒ›áƒ˜áƒ¡ áƒ›áƒáƒ¥áƒ›áƒ”áƒ“áƒ”áƒ‘áƒáƒ¡
            // "UP", "DOWN" áƒáƒœ "OK" áƒ‘áƒ áƒ«áƒáƒœáƒ”áƒ‘áƒ”áƒ‘áƒ–áƒ”.
            ui_menu_handle_navigation(private_data, button_name);
        }
        // ...
    }
    // ...
}
```
