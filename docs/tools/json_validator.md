# ­ЪЊЮ `JSON` рЃЋрЃљрЃџрЃўрЃЊрЃљрЃбрЃЮрЃарЃў (`validate_jsons.py`)

## 1. ­Ъј» рЃЊрЃљрЃюрЃўрЃерЃюрЃБрЃџрЃћрЃЉрЃљ

`validate_jsons.py` рЃљрЃарЃўрЃА Synapse Framework-рЃўрЃА **рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА "рЃЏрЃфрЃЋрЃћрЃџрЃў"**. рЃћрЃА рЃљрЃарЃўрЃА Python рЃАрЃЎрЃарЃўрЃърЃбрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃўрЃюрЃбрЃћрЃњрЃарЃўрЃарЃћрЃЉрЃБрЃџрЃўрЃљ build рЃАрЃўрЃАрЃбрЃћрЃЏрЃљрЃерЃў рЃЊрЃљ рЃЏрЃўрЃАрЃў рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў рЃљрЃЏрЃЮрЃфрЃљрЃюрЃљрЃљ, **рЃЎрЃЮрЃЏрЃърЃўрЃџрЃљрЃфрЃўрЃўрЃА рЃЊрЃљрЃгрЃДрЃћрЃЉрЃљрЃЏрЃЊрЃћ** рЃерЃћрЃљрЃЏрЃЮрЃгрЃЏрЃЮрЃА рЃърЃарЃЮрЃћрЃЦрЃбрЃерЃў рЃљрЃарЃАрЃћрЃЉрЃБрЃџрЃў рЃДрЃЋрЃћрЃџрЃљ `module.json` рЃЊрЃљ `config.json` рЃцрЃљрЃўрЃџрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃБрЃџрЃў рЃАрЃўрЃАрЃгрЃЮрЃарЃћ.

рЃћрЃА рЃўрЃюрЃАрЃбрЃарЃБрЃЏрЃћрЃюрЃбрЃў рЃБрЃќрЃарЃБрЃюрЃЋрЃћрЃџрЃДрЃЮрЃцрЃА, рЃарЃЮрЃЏ:

- рЃДрЃЋрЃћрЃџрЃљ рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃцрЃљрЃўрЃџрЃў рЃерЃћрЃћрЃАрЃљрЃЉрЃљрЃЏрЃћрЃЉрЃљ рЃгрЃўрЃюрЃљрЃАрЃгрЃљрЃа рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃБрЃџ рЃАрЃЦрЃћрЃЏрЃљрЃА (`schema`).
- рЃљрЃа рЃљрЃарЃўрЃА рЃњрЃљрЃЏрЃЮрЃбрЃЮрЃЋрЃћрЃЉрЃБрЃџрЃў рЃАрЃљрЃЋрЃљрЃџрЃЊрЃћрЃЉрЃБрЃџрЃЮ рЃЋрЃћрЃџрЃћрЃЉрЃў.
- рЃЋрЃћрЃџрЃћрЃЉрЃўрЃА рЃбрЃўрЃърЃћрЃЉрЃў (рЃАрЃбрЃарЃўрЃЦрЃЮрЃюрЃў, рЃарЃўрЃфрЃ«рЃЋрЃў, рЃџрЃЮрЃњрЃўрЃЎрЃБрЃарЃў) рЃЎрЃЮрЃарЃћрЃЦрЃбрЃБрЃџрЃўрЃљ.
- рЃљрЃа рЃљрЃарЃўрЃА рЃЊрЃљрЃерЃЋрЃћрЃЉрЃБрЃџрЃў рЃќрЃћрЃЊрЃЏрЃћрЃбрЃў, рЃБрЃфрЃ«рЃЮ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў.

рЃерЃћрЃЊрЃћрЃњрЃљрЃЊ, рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљрЃАрЃЌрЃљрЃю рЃЊрЃљрЃЎрЃљрЃЋрЃерЃўрЃарЃћрЃЉрЃБрЃџрЃў рЃерЃћрЃфрЃЊрЃЮрЃЏрЃћрЃЉрЃў рЃЋрЃџрЃўрЃюрЃЊрЃћрЃЉрЃљ рЃљрЃарЃљ рЃЏрЃЮрЃгрЃДрЃЮрЃЉрЃўрЃџрЃЮрЃЉрЃљрЃќрЃћ, `runtime`-рЃерЃў, рЃљрЃарЃљрЃЏрЃћрЃЊ рЃЊрЃћрЃЋрЃћрЃџрЃЮрЃърЃћрЃарЃўрЃА рЃЎрЃЮрЃЏрЃърЃўрЃБрЃбрЃћрЃарЃерЃў, `build`-рЃўрЃА рЃЊрЃарЃЮрЃА, рЃарЃљрЃф рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃюрЃљрЃЊ рЃљрЃЕрЃЦрЃљрЃарЃћрЃЉрЃА рЃЊрЃљ рЃљрЃЏрЃљрЃарЃбрЃўрЃЋрЃћрЃЉрЃА рЃњрЃљрЃЏрЃљрЃарЃЌрЃЋрЃўрЃА рЃърЃарЃЮрЃфрЃћрЃАрЃА.

## 2. ­ЪЈЏ№ИЈ рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ

рЃЋрЃљрЃџрЃўрЃЊрЃљрЃфрЃўрЃўрЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃљ рЃерЃћрЃЊрЃњрЃћрЃЉрЃљ рЃАрЃљрЃЏрЃў рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃюрЃљрЃгрЃўрЃџрЃўрЃАрЃњрЃљрЃю:

1. **рЃАрЃЦрЃћрЃЏрЃўрЃА рЃцрЃљрЃўрЃџрЃћрЃЉрЃў (`*.schema.json`):**
    - **`tools/schemas/module_schema.json`:** рЃћрЃА рЃљрЃарЃўрЃА **рЃњрЃџрЃЮрЃЉрЃљрЃџрЃБрЃарЃў рЃАрЃЦрЃћрЃЏрЃљ**, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃљрЃдрЃгрЃћрЃарЃА `module.json` рЃцрЃљрЃўрЃџрЃўрЃА рЃАрЃљрЃЋрЃљрЃџрЃЊрЃћрЃЉрЃБрЃџрЃЮ рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљрЃА. рЃўрЃА рЃЋрЃарЃфрЃћрЃџрЃЊрЃћрЃЉрЃљ рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃДрЃЋрЃћрЃџрЃљ рЃЏрЃЮрЃЊрЃБрЃџрЃќрЃћ.
    - **`{module_name}/schema.json`:** рЃћрЃА рЃљрЃарЃўрЃА **рЃџрЃЮрЃЎрЃљрЃџрЃБрЃарЃў рЃАрЃЦрЃћрЃЏрЃљ**, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџ рЃЏрЃЮрЃЊрЃБрЃџрЃА рЃерЃћрЃБрЃФрЃџрЃўрЃљ, рЃ░рЃЦрЃЮрЃюрЃЊрЃћрЃА. рЃўрЃА рЃљрЃдрЃгрЃћрЃарЃА рЃЎрЃЮрЃюрЃЎрЃарЃћрЃбрЃБрЃџрЃљрЃЊ рЃљрЃЏ рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА `config.json` рЃцрЃљрЃўрЃџрЃўрЃА рЃБрЃюрЃўрЃЎрЃљрЃџрЃБрЃа рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљрЃАрЃљ рЃЊрЃљ рЃЏрЃЮрЃЌрЃ«рЃЮрЃЋрЃюрЃћрЃЉрЃА.

2. **рЃЋрЃљрЃџрЃўрЃЊрЃљрЃбрЃЮрЃарЃў рЃАрЃЎрЃарЃўрЃърЃбрЃў (`tools/validate_jsons.py`):**
    - Python рЃАрЃЎрЃарЃўрЃърЃбрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃўрЃДрЃћрЃюрЃћрЃЉрЃА `jsonschema` рЃЉрЃўрЃЉрЃџрЃўрЃЮрЃЌрЃћрЃЎрЃљрЃА.
    - рЃўрЃА рЃљрЃарЃњрЃБрЃЏрЃћрЃюрЃбрЃљрЃЊ рЃўрЃдрЃћрЃЉрЃА рЃерЃћрЃАрЃљрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃћрЃџ JSON рЃцрЃљрЃўрЃџрЃА рЃЊрЃљ рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃА рЃАрЃЦрЃћрЃЏрЃўрЃА рЃцрЃљрЃўрЃџрЃА.
    - рЃерЃћрЃБрЃАрЃљрЃЉрЃљрЃЏрЃЮрЃЉрЃўрЃА рЃљрЃдрЃЏрЃЮрЃЕрЃћрЃюрЃўрЃА рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў, рЃўрЃА рЃљрЃЕрЃћрЃарЃћрЃЉрЃА `build` рЃърЃарЃЮрЃфрЃћрЃАрЃА рЃЊрЃљ рЃбрЃћрЃарЃЏрЃўрЃюрЃљрЃџрЃерЃў рЃЉрЃћрЃГрЃЊрЃљрЃЋрЃА рЃЊрЃћрЃбрЃљрЃџрЃБрЃа, рЃљрЃЊрЃљрЃЏрЃўрЃљрЃюрЃўрЃАрЃЌрЃЋрЃўрЃА рЃњрЃљрЃАрЃљрЃњрЃћрЃЉ рЃерЃћрЃфрЃЊрЃЮрЃЏрЃўрЃА рЃерЃћрЃбрЃДрЃЮрЃЉрЃўрЃюрЃћрЃЉрЃљрЃА.

3. **`CMake` рЃўрЃюрЃбрЃћрЃњрЃарЃљрЃфрЃўрЃљ (`validate_configs.cmake`):**
    - `core` рЃЎрЃЮрЃЏрЃърЃЮрЃюрЃћрЃюрЃбрЃўрЃА `CMakeLists.txt`-рЃерЃў рЃЕрЃљрЃерЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃАрЃЎрЃарЃўрЃърЃбрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф `build`-рЃўрЃА рЃЊрЃљрЃАрЃљрЃгрЃДрЃўрЃАрЃерЃў рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃърЃЮрЃБрЃџрЃЮрЃЉрЃА рЃДрЃЋрЃћрЃџрЃљ `module.json` рЃЊрЃљ `config.json` рЃцрЃљрЃўрЃџрЃА (рЃарЃЮрЃЏрЃџрЃћрЃЉрЃАрЃљрЃф рЃљрЃЦрЃЋрЃЌ `schema.json`) рЃЊрЃљ рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃўрЃАрЃЌрЃЋрЃўрЃА рЃўрЃФрЃљрЃ«рЃћрЃЉрЃА рЃЋрЃљрЃџрЃўрЃЊрЃљрЃбрЃЮрЃарЃА.

## 3. ­ЪЏа№ИЈ рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљ

рЃЋрЃљрЃџрЃўрЃЊрЃљрЃбрЃЮрЃарЃў рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА **рЃАрЃарЃБрЃџрЃљрЃЊ рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃа рЃарЃћрЃЪрЃўрЃЏрЃерЃў**. рЃЊрЃћрЃЋрЃћрЃџрЃЮрЃърЃћрЃарЃўрЃАрЃњрЃљрЃю рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃЏрЃЮрЃЦрЃЏрЃћрЃЊрЃћрЃЉрЃљ рЃАрЃљрЃГрЃўрЃарЃЮ рЃљрЃа рЃљрЃарЃўрЃА.

- **`idf.py build`**-рЃўрЃА рЃњрЃљрЃерЃЋрЃћрЃЉрЃўрЃАрЃљрЃА, рЃЋрЃљрЃџрЃўрЃЊрЃљрЃфрЃўрЃљ рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃерЃћрЃАрЃарЃБрЃџрЃЊрЃћрЃЉрЃљ.
- рЃЌрЃБ рЃерЃћрЃфрЃЊрЃЮрЃЏрЃљ рЃљрЃдрЃЏрЃЮрЃЕрЃюрЃЊрЃљ, `build` рЃърЃарЃЮрЃфрЃћрЃАрЃў рЃерЃћрЃЕрЃћрЃарЃЊрЃћрЃЉрЃљ рЃЊрЃљ рЃњрЃљрЃЏрЃЮрЃЕрЃюрЃЊрЃћрЃЉрЃљ рЃерЃћрЃбрЃДрЃЮрЃЉрЃўрЃюрЃћрЃЉрЃљ, рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ:

    ```
    РЮї Schema validation failed for .../relay_actuator/config.json:
       - Error: 'pin' is a required property
       - Path: ['config']
       - Validator: required = ['instance_name', 'pin']
    ```

## 4. РюЇ№ИЈ рЃарЃЮрЃњрЃЮрЃа рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃЮрЃЌ рЃЋрЃљрЃџрЃўрЃЊрЃљрЃфрЃўрЃљ рЃљрЃ«рЃљрЃџ рЃЏрЃЮрЃЊрЃБрЃџрЃА?

рЃарЃЮрЃЊрЃћрЃАрЃљрЃф рЃЦрЃЏрЃюрЃўрЃЌ рЃљрЃ«рЃљрЃџ рЃЏрЃЮрЃЊрЃБрЃџрЃА, `create_module.py` рЃАрЃЎрЃарЃўрЃърЃбрЃў рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃљрЃњрЃћрЃюрЃћрЃарЃўрЃарЃћрЃЉрЃА `schema.json` рЃцрЃљрЃўрЃџрЃўрЃА рЃЕрЃЮрЃюрЃЕрЃ«рЃА. рЃЌрЃЦрЃЋрЃћрЃюрЃў рЃљрЃЏрЃЮрЃфрЃљрЃюрЃљрЃљ, рЃерЃћрЃљрЃЋрЃАрЃЮрЃЌ рЃўрЃА рЃЌрЃЦрЃЋрЃћрЃюрЃў `config.json`-рЃўрЃА рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃАрЃљрЃЊ.

**рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў (`my_sensor/schema.json`):**

```json
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "My Sensor Config Schema",
    "type": "object",
    "properties": {
        "type": { "const": "my_sensor" },
        "enabled": { "type": "boolean" },
        "config": {
            "type": "object",
            "properties": {
                "instance_name": { "type": "string", "minLength": 1 },
                "update_interval_sec": { 
                    "type": "integer", 
                    "minimum": 5,
                    "description": "The interval in seconds for sensor readings."
                },
                "i2c_bus_service": { "type": "string" }
            },
            "required": ["instance_name", "update_interval_sec", "i2c_bus_service"]
        }
    },
    "required": ["type", "config"]
}
```

рЃљрЃЏ рЃАрЃЦрЃћрЃЏрЃўрЃА рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ, рЃЋрЃљрЃџрЃўрЃЊрЃљрЃбрЃЮрЃарЃў рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃерЃћрЃљрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃА, рЃарЃЮрЃЏ `my_sensor`-рЃўрЃА `config.json`-рЃерЃў `update_interval_sec` рЃљрЃарЃўрЃА 5-рЃќрЃћ рЃЏрЃћрЃбрЃў рЃарЃўрЃфрЃ«рЃЋрЃў.
