# ­ЪњА рЃЏрЃЮрЃЊрЃБрЃџрЃў `rgb_led_indicator`

## 1. рЃЏрЃўрЃЏрЃЮрЃ«рЃўрЃџрЃЋрЃљ

**рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃАрЃљрЃ«рЃћрЃџрЃў:** `rgb_led_indicator`  
**рЃЎрЃљрЃбрЃћрЃњрЃЮрЃарЃўрЃљ:** `displays`  
**рЃЋрЃћрЃарЃАрЃўрЃљ:** 1.1.0  
**рЃљрЃЋрЃбрЃЮрЃарЃў:** рЃњрЃўрЃЮрЃарЃњрЃў рЃЏрЃљрЃњрЃарЃљрЃФрЃћ & Synapse AI Assistant

`rgb_led_indicator` рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃБрЃќрЃарЃБрЃюрЃЋрЃћрЃџрЃДрЃЮрЃцрЃА рЃБрЃюрЃўрЃЋрЃћрЃарЃАрЃљрЃџрЃБрЃа, рЃЏрЃљрЃдрЃљрЃџрЃў рЃЊрЃЮрЃюрЃўрЃА рЃўрЃюрЃбрЃћрЃарЃцрЃћрЃўрЃАрЃА RGB LED рЃўрЃюрЃЊрЃўрЃЎрЃљрЃбрЃЮрЃарЃўрЃА рЃАрЃљрЃЏрЃљрЃарЃЌрЃљрЃЋрЃљрЃЊ. рЃўрЃА рЃерЃћрЃЦрЃЏрЃюрЃўрЃџрЃўрЃљ рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃАрЃбрЃљрЃбрЃБрЃАрЃўрЃА рЃўрЃюрЃЊрЃўрЃЎрЃљрЃбрЃЮрЃарЃўрЃА рЃарЃЮрЃџрЃўрЃА рЃерЃћрЃАрЃљрЃАрЃарЃБрЃџрЃћрЃЉрЃџрЃљрЃЊ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃљрЃЋрЃбрЃЮрЃюрЃЮрЃЏрЃўрЃБрЃарЃљрЃЊ рЃарЃћрЃљрЃњрЃўрЃарЃћрЃЉрЃА рЃцрЃарЃћрЃўрЃЏрЃЋрЃЮрЃарЃЦрЃўрЃА рЃЎрЃарЃўрЃбрЃўрЃЎрЃБрЃџ рЃўрЃЋрЃћрЃюрЃЌрЃћрЃЉрЃќрЃћ рЃЊрЃљ, рЃљрЃЏрЃљрЃЋрЃЊрЃарЃЮрЃБрЃџрЃљрЃЊ, рЃљрЃгрЃЋрЃЊрЃўрЃА рЃАрЃћрЃарЃЋрЃўрЃАрЃўрЃА API-рЃА рЃЊрЃљ CLI рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃћрЃЉрЃА рЃАрЃ«рЃЋрЃљ рЃЏрЃЮрЃЊрЃБрЃџрЃћрЃЉрЃўрЃАрЃљ рЃЊрЃљ рЃЏрЃЮрЃЏрЃ«рЃЏрЃљрЃарЃћрЃЉрЃџрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА, рЃарЃљрЃЌрЃљ рЃЏрЃљрЃЌ рЃЏрЃЮрЃўрЃЌрЃ«рЃЮрЃЋрЃЮрЃю рЃАрЃърЃћрЃфрЃўрЃцрЃўрЃЎрЃБрЃарЃў рЃЋрЃўрЃќрЃБрЃљрЃџрЃБрЃарЃў рЃерЃћрЃбрЃДрЃЮрЃЉрЃўрЃюрЃћрЃЉрЃћрЃЉрЃў.

рЃЏрЃЮрЃЊрЃБрЃџрЃА рЃљрЃЦрЃЋрЃА рЃАрЃбрЃљрЃбрЃўрЃЎрЃБрЃарЃў рЃцрЃћрЃарЃћрЃЉрЃўрЃА, рЃфрЃўрЃЏрЃфрЃўрЃЏрЃўрЃА рЃЊрЃљ рЃърЃБрЃџрЃАрЃљрЃфрЃўрЃўрЃА рЃћрЃцрЃћрЃЦрЃбрЃћрЃЉрЃўрЃА рЃЏрЃ«рЃљрЃарЃЊрЃљрЃГрЃћрЃарЃљ, рЃарЃЮрЃЏрЃџрЃћрЃЉрЃўрЃф рЃўрЃЏрЃљрЃарЃЌрЃћрЃЉрЃљ рЃфрЃљрЃџрЃЎрЃћ FreeRTOS рЃбрЃљрЃАрЃЎрЃўрЃА рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃўрЃЌ, рЃарЃљрЃЌрЃљ рЃБрЃќрЃарЃБрЃюрЃЋрЃћрЃџрЃДрЃЮрЃцрЃўрЃџрЃў рЃўрЃДрЃЮрЃА рЃЮрЃърЃћрЃарЃљрЃфрЃўрЃћрЃЉрЃўрЃА рЃљрЃарЃљрЃЉрЃџрЃЮрЃЎрЃўрЃарЃћрЃЉрЃљрЃЊрЃў, рЃљрЃАрЃўрЃюрЃЦрЃарЃЮрЃюрЃБрЃџрЃў рЃерЃћрЃАрЃарЃБрЃџрЃћрЃЉрЃљ.

## 2. рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃБрЃџрЃў рЃърЃарЃўрЃюрЃфрЃўрЃърЃћрЃЉрЃў

- **рЃ░рЃўрЃЉрЃарЃўрЃЊрЃБрЃџрЃў рЃЎрЃЮрЃЏрЃБрЃюрЃўрЃЎрЃљрЃфрЃўрЃљ:** рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃћрЃарЃЌрЃЊрЃарЃЮрЃБрЃџрЃљрЃЊ рЃљрЃарЃўрЃА **Service-driven** рЃЊрЃљ **Event-driven**.
  - рЃўрЃА **рЃљрЃгрЃЋрЃЊрЃўрЃА рЃАрЃћрЃарЃЋрЃўрЃАрЃА** (`rgb_led_api`) `Service Locator`-рЃўрЃА рЃЏрЃћрЃерЃЋрЃћрЃЮрЃЉрЃўрЃЌ рЃАрЃ«рЃЋрЃљ рЃЏрЃЮрЃЊрЃБрЃџрЃћрЃЉрЃўрЃА рЃЏрЃўрЃћрЃа рЃърЃўрЃарЃЊрЃљрЃърЃўрЃарЃў рЃЏрЃљрЃарЃЌрЃЋрЃўрЃАрЃЌрЃЋрЃўрЃА (рЃЏрЃљрЃњ., OTA рЃњрЃљрЃюрЃљрЃ«рЃџрЃћрЃЉрЃўрЃА рЃърЃарЃЮрЃфрЃћрЃАрЃў, рЃЏрЃЮрЃЏрЃ«рЃЏрЃљрЃарЃћрЃЉрЃџрЃўрЃА рЃџрЃЮрЃњрЃўрЃЎрЃљ).
  - рЃўрЃА **рЃњрЃљрЃЏрЃЮрЃўрЃгрЃћрЃарЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃБрЃа рЃўрЃЋрЃћрЃюрЃЌрЃћрЃЉрЃА** `Event Bus`-рЃќрЃћ, рЃарЃљрЃЌрЃљ рЃљрЃАрЃљрЃ«рЃЮрЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃќрЃЮрЃњрЃљрЃЊрЃў рЃЏрЃЊрЃњрЃЮрЃЏрЃљрЃарЃћрЃЮрЃЉрЃљ (рЃЏрЃљрЃњ., Wi-Fi/Provisioning рЃАрЃбрЃљрЃбрЃБрЃАрЃў).
- **рЃарЃћрЃАрЃБрЃарЃАрЃћрЃЉрЃўрЃА рЃЏрЃљрЃарЃЌрЃЋрЃљ:** рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃўрЃДрЃћрЃюрЃћрЃЉрЃА `Resource Manager`-рЃА рЃАрЃљрЃГрЃўрЃарЃЮ GPIO рЃърЃўрЃюрЃћрЃЉрЃўрЃА рЃЊрЃљрЃАрЃљрЃџрЃЮрЃЦрЃљрЃЊ, рЃарЃљрЃЌрЃљ рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃю рЃљрЃўрЃфрЃўрЃџрЃЮрЃА рЃЎрЃЮрЃюрЃцрЃџрЃўрЃЦрЃбрЃћрЃЉрЃў.
- **рЃљрЃАрЃўрЃюрЃЦрЃарЃЮрЃюрЃБрЃџрЃў рЃЮрЃърЃћрЃарЃљрЃфрЃўрЃћрЃЉрЃў:** LED рЃћрЃцрЃћрЃЦрЃбрЃћрЃЉрЃў (рЃфрЃўрЃЏрЃфрЃўрЃЏрЃў, рЃърЃБрЃџрЃАрЃљрЃфрЃўрЃљ) рЃўрЃЏрЃљрЃарЃЌрЃћрЃЉрЃљ рЃњрЃљрЃЏрЃЮрЃДрЃЮрЃцрЃўрЃџрЃў рЃбрЃљрЃАрЃЎрЃўрЃА рЃЏрЃўрЃћрЃа, рЃарЃљрЃф рЃБрЃќрЃарЃБрЃюрЃЋрЃћрЃџрЃДрЃЮрЃцрЃА, рЃарЃЮрЃЏ API рЃњрЃљрЃЏрЃЮрЃФрЃљрЃ«рЃћрЃЉрЃћрЃЉрЃў рЃљрЃа рЃўрЃДрЃЮрЃА рЃЏрЃЉрЃџрЃЮрЃЎрЃљрЃЋрЃў.
- **рЃърЃарЃўрЃЮрЃарЃўрЃбрЃћрЃбрЃћрЃЉрЃўрЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃљ:** рЃЏрЃљрЃарЃбрЃўрЃЋрЃў рЃърЃарЃўрЃЮрЃарЃўрЃбрЃћрЃбрЃБрЃџрЃў рЃЏрЃћрЃЦрЃљрЃюрЃўрЃќрЃЏрЃў рЃЏрЃљрЃарЃЌрЃљрЃЋрЃА рЃЎрЃЮрЃюрЃцрЃџрЃўрЃЦрЃбрЃА "рЃЏрЃћрЃЦрЃљрЃюрЃўрЃЎрЃБрЃа" рЃЏрЃљрЃарЃЌрЃЋрЃљрЃАрЃљ рЃЊрЃљ рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃАрЃбрЃљрЃбрЃБрЃАрЃўрЃА рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃа рЃЕрЃЋрЃћрЃюрЃћрЃЉрЃљрЃА рЃерЃЮрЃарЃўрЃА. рЃЏрЃћрЃЦрЃљрЃюрЃўрЃЎрЃБрЃа рЃЏрЃљрЃарЃЌрЃЋрЃљрЃА (Service API-рЃА рЃљрЃю CLI рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃФрЃљрЃ«рЃћрЃЉрЃўрЃЌ) рЃДрЃЮрЃЋрЃћрЃџрЃЌрЃЋрЃўрЃА рЃБрЃЏрЃљрЃдрЃџрЃћрЃАрЃў рЃърЃарЃўрЃЮрЃарЃўрЃбрЃћрЃбрЃў рЃљрЃЦрЃЋрЃА.
- **CLI рЃўрЃюрЃбрЃћрЃњрЃарЃљрЃфрЃўрЃљ:** рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃљрЃарЃћрЃњрЃўрЃАрЃбрЃарЃўрЃарЃћрЃЉрЃА рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃћрЃЉрЃА `Command Router`-рЃерЃў, рЃарЃљрЃф рЃўрЃФрЃџрЃћрЃЋрЃљ рЃАрЃћрЃарЃўрЃБрЃџрЃў рЃърЃЮрЃарЃбрЃўрЃЊрЃљрЃю рЃўрЃюрЃбрЃћрЃарЃљрЃЦрЃбрЃўрЃБрЃџрЃў рЃЏрЃљрЃарЃЌрЃЋрЃўрЃА рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃљрЃА.

## 3. рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ

рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ рЃ«рЃЊрЃћрЃЉрЃљ `system_config.json` рЃцрЃљрЃўрЃџрЃўрЃА рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃўрЃЌ.

**рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў:**

```json
{
    "type": "rgb_led_indicator",
    "enabled": true,
    "config": {
        "instance_name": "status_led",
        "red_pin": 25,
        "green_pin": 26,
        "blue_pin": 27,
        "is_common_anode": false
    }
}
```

**рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў:**

| рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў | рЃбрЃўрЃърЃў | рЃљрЃдрЃгрЃћрЃарЃљ | рЃАрЃљрЃЋрЃљрЃџрЃЊрЃћрЃЉрЃБрЃџрЃЮ | Default |
|:---|:---|:---|:---:|:---|
| `instance_name` | рЃАрЃбрЃарЃўрЃЦрЃЮрЃюрЃў | рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃўрЃюрЃАрЃбрЃљрЃюрЃфрЃўрЃўрЃА рЃБрЃюрЃўрЃЎрЃљрЃџрЃБрЃарЃў рЃАрЃљрЃ«рЃћрЃџрЃў. | РюЁ | `main_rgb_led`|
| `red_pin` | рЃарЃўрЃфрЃ«рЃЋрЃў | RED рЃљрЃарЃ«рЃўрЃАрЃЌрЃЋрЃўрЃА рЃњрЃљрЃюрЃЎрЃБрЃЌрЃЋрЃюрЃўрЃџрЃў GPIO рЃърЃўрЃюрЃў. | РюЁ | - |
| `green_pin` | рЃарЃўрЃфрЃ«рЃЋрЃў | GREEN рЃљрЃарЃ«рЃўрЃАрЃЌрЃЋрЃўрЃА рЃњрЃљрЃюрЃЎрЃБрЃЌрЃЋрЃюрЃўрЃџрЃў GPIO рЃърЃўрЃюрЃў. | РюЁ | - |
| `blue_pin` | рЃарЃўрЃфрЃ«рЃЋрЃў | BLUE рЃљрЃарЃ«рЃўрЃАрЃЌрЃЋрЃўрЃА рЃњрЃљрЃюрЃЎрЃБрЃЌрЃЋрЃюрЃўрЃџрЃў GPIO рЃърЃўрЃюрЃў. | РюЁ | - |
| `is_common_anode` | boolean | `true`, рЃЌрЃБ рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ рЃАрЃљрЃћрЃарЃЌрЃЮ рЃљрЃюрЃЮрЃЊрЃўрЃА рЃЏрЃЦрЃЮрЃюрЃћ RGB LED. | РЮї | `false` |

## 4. Service API (`rgb_led_api_t`)

рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃљрЃарЃћрЃњрЃўрЃАрЃбрЃарЃўрЃарЃћрЃЉрЃА рЃАрЃћрЃарЃЋрЃўрЃАрЃА, рЃарЃЮрЃЏрЃџрЃўрЃА рЃбрЃўрЃърЃўрЃљ `FMW_SERVICE_TYPE_RGB_LED_API`.

**API рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў:**

- **`esp_err_t set_color(uint8_t r, uint8_t g, uint8_t b);`**  
  рЃљрЃДрЃћрЃюрЃћрЃЉрЃА рЃАрЃбрЃљрЃбрЃўрЃЎрЃБрЃа рЃцрЃћрЃарЃА. рЃћрЃА рЃЏрЃЮрЃЦрЃЏрЃћрЃЊрЃћрЃЉрЃљ рЃњрЃљрЃЊрЃљрЃцрЃљрЃарЃљрЃЋрЃА рЃюрЃћрЃЉрЃўрЃАрЃЏрЃўрЃћрЃа рЃљрЃЦрЃбрЃўрЃБрЃа рЃћрЃцрЃћрЃЦрЃбрЃА рЃљрЃю рЃАрЃўрЃАрЃбрЃћрЃЏрЃБрЃарЃў рЃАрЃбрЃљрЃбрЃБрЃАрЃўрЃА рЃцрЃћрЃарЃА.

- **`esp_err_t start_blink(uint8_t r, uint8_t g, uint8_t b, uint32_t interval_ms);`**  
  рЃўрЃгрЃДрЃћрЃЉрЃА рЃфрЃўрЃЏрЃфрЃўрЃЏрЃА рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃБрЃџрЃў рЃцрЃћрЃарЃўрЃЌрЃљ рЃЊрЃљ рЃўрЃюрЃбрЃћрЃарЃЋрЃљрЃџрЃўрЃЌ.

- **`esp_err_t start_pulse(uint8_t r, uint8_t g, uint8_t b, uint32_t period_ms);`**  
  рЃўрЃгрЃДрЃћрЃЉрЃА "рЃърЃБрЃџрЃАрЃљрЃфрЃўрЃўрЃА" рЃћрЃцрЃћрЃЦрЃбрЃА (рЃАрЃўрЃЎрЃљрЃерЃЎрЃљрЃерЃўрЃА рЃњрЃџрЃБрЃЋрЃў рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃљ) рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃБрЃџрЃў рЃцрЃћрЃарЃўрЃЌрЃљ рЃЊрЃљ рЃърЃћрЃарЃўрЃЮрЃЊрЃўрЃЌ.

- **`esp_err_t turn_off();`**  
  рЃЌрЃўрЃерЃљрЃЋрЃА LED рЃўрЃюрЃЊрЃўрЃЎрЃљрЃбрЃЮрЃарЃА. рЃћрЃЎрЃЋрЃўрЃЋрЃљрЃџрЃћрЃюрЃбрЃБрЃарЃўрЃљ `set_color(0, 0, 0)`-рЃўрЃА.

- **`esp_err_t release_control();`**  
  рЃљрЃЌрЃљрЃЋрЃўрЃАрЃБрЃцрЃџрЃћрЃЉрЃА "рЃЏрЃћрЃЦрЃљрЃюрЃўрЃЎрЃБрЃа" рЃЏрЃљрЃарЃЌрЃЋрЃљрЃА рЃЊрЃљ рЃљрЃЉрЃарЃБрЃюрЃћрЃЉрЃА рЃўрЃюрЃЊрЃўрЃЎрЃљрЃбрЃЮрЃарЃА рЃЏрЃўрЃА рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃа, рЃўрЃЋрЃћрЃюрЃЌрЃћрЃЉрЃќрЃћ рЃЊрЃљрЃЏрЃЮрЃЎрЃўрЃЊрЃћрЃЉрЃБрЃџ рЃарЃћрЃЪрЃўрЃЏрЃерЃў.

## 5. Рїе№ИЈ CLI рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃћрЃЉрЃў (Command Line Interface)

рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃљрЃарЃћрЃњрЃўрЃАрЃбрЃарЃўрЃарЃћрЃЉрЃА `led` рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃљрЃА `Command Router`-рЃерЃў, рЃарЃљрЃф рЃўрЃФрЃџрЃћрЃЋрЃљ рЃАрЃћрЃарЃўрЃБрЃџрЃў рЃЎрЃЮрЃюрЃАрЃЮрЃџрЃўрЃЊрЃљрЃю LED-рЃўрЃА рЃАрЃарЃБрЃџрЃў рЃЏрЃљрЃарЃЌрЃЋрЃўрЃА рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃљрЃА.

| рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃљ | рЃљрЃарЃњрЃБрЃЏрЃћрЃюрЃбрЃћрЃЉрЃў | рЃљрЃдрЃгрЃћрЃарЃљ |
|:---|:---|:---|
| `led set` | `<r> <g> <b>` | ­Ъје рЃљрЃДрЃћрЃюрЃћрЃЉрЃА рЃАрЃбрЃљрЃбрЃўрЃЎрЃБрЃа рЃцрЃћрЃарЃА. рЃЏрЃљрЃњ: `led set 255 0 255` (рЃўрЃљрЃАрЃљрЃЏрЃюрЃўрЃАрЃцрЃћрЃарЃў). |
| `led blink` | `<r> <g> <b> <interval>` | Рюе рЃўрЃгрЃДрЃћрЃЉрЃА рЃфрЃўрЃЏрЃфрЃўрЃЏрЃА. `<interval>` рЃљрЃарЃўрЃА рЃЏрЃўрЃџрЃўрЃгрЃљрЃЏрЃћрЃЉрЃерЃў. рЃЏрЃљрЃњ: `led blink 0 0 255 500`. |
| `led pulse` | `<r> <g> <b> <period>` | ­Ъїі рЃўрЃгрЃДрЃћрЃЉрЃА рЃърЃБрЃџрЃАрЃљрЃфрЃўрЃљрЃА. `<period>` рЃљрЃарЃўрЃА рЃЏрЃўрЃџрЃўрЃгрЃљрЃЏрЃћрЃЉрЃерЃў. рЃЏрЃљрЃњ: `led pulse 255 165 0 3000`. |
| `led off` | - | РџФ рЃЌрЃўрЃерЃљрЃЋрЃА LED-рЃА. |
| `led release` | - | ­Ъћё рЃљрЃЌрЃљрЃЋрЃўрЃАрЃБрЃцрЃџрЃћрЃЉрЃА рЃЏрЃћрЃЦрЃљрЃюрЃўрЃЎрЃБрЃа рЃЎрЃЮрЃюрЃбрЃарЃЮрЃџрЃА рЃЊрЃљ рЃљрЃЉрЃарЃБрЃюрЃћрЃЉрЃА LED-рЃА рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃа рЃарЃћрЃЪрЃўрЃЏрЃерЃў. |

## 6. рЃўрЃЋрЃћрЃюрЃЌрЃћрЃЉрЃўрЃА рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ

рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃњрЃљрЃЏрЃЮрЃўрЃгрЃћрЃарЃА рЃерЃћрЃЏрЃЊрЃћрЃњ рЃўрЃЋрЃћрЃюрЃЌрЃћрЃЉрЃА рЃАрЃбрЃљрЃбрЃБрЃАрЃўрЃА рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃАрЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃџрЃљрЃЊ:

| рЃўрЃЋрЃћрЃюрЃЌрЃўрЃА рЃАрЃљрЃ«рЃћрЃџрЃў | LED-рЃўрЃА рЃЦрЃфрЃћрЃЋрЃљ | рЃърЃарЃўрЃЮрЃарЃўрЃбрЃћрЃбрЃў |
|:---|:---|:---:|
| `WIFI_CREDENTIALS_NOT_FOUND` | ­ЪњЏ рЃърЃБрЃџрЃАрЃўрЃарЃћрЃЉрЃљрЃЊрЃў **рЃДрЃЋрЃўрЃЌрЃћрЃџрЃў** (рЃЦрЃљрЃарЃЋрЃўрЃАрЃцрЃћрЃарЃў) | рЃАрЃўрЃАрЃбрЃћрЃЏрЃБрЃарЃў |
| `WIFI_EVENT_STA_START` | РЮц№ИЈ рЃБрЃгрЃДрЃЋрЃћрЃбрЃў **рЃгрЃўрЃЌрЃћрЃџрЃў** рЃцрЃћрЃарЃў | рЃАрЃўрЃАрЃбрЃћрЃЏрЃБрЃарЃў |
| `WIFI_EVENT_STA_CONNECTED` | ­Ъњџ **рЃЏрЃгрЃЋрЃљрЃюрЃћрЃЊ** рЃљрЃфрЃўрЃЏрЃфрЃўрЃЏрЃћрЃЉрЃљ 3-рЃ»рЃћрЃа, рЃерЃћрЃЏрЃЊрЃћрЃњ рЃњрЃљрЃЌрЃўрЃерЃЋрЃљ | рЃАрЃўрЃАрЃбрЃћрЃЏрЃБрЃарЃў |
| `WIFI_EVENT_STA_DISCONNECTED` | РЮц№ИЈ рЃБрЃгрЃДрЃЋрЃћрЃбрЃў **рЃгрЃўрЃЌрЃћрЃџрЃў** рЃцрЃћрЃарЃў | рЃАрЃўрЃАрЃбрЃћрЃЏрЃБрЃарЃў |
| `SYSTEM_HEALTH_ALERT` | РЮц№ИЈ рЃАрЃгрЃарЃљрЃцрЃў **рЃгрЃўрЃЌрЃћрЃџрЃў** рЃфрЃўрЃЏрЃфрЃўрЃЏрЃў | рЃАрЃўрЃАрЃбрЃћрЃЏрЃБрЃарЃў |
| (рЃюрЃћрЃЉрЃўрЃАрЃЏрЃўрЃћрЃарЃў Service API/CLI рЃњрЃљрЃЏрЃЮрЃФрЃљрЃ«рЃћрЃЉрЃљ) | рЃњрЃљрЃЏрЃЮрЃФрЃљрЃ«рЃћрЃЉрЃўрЃА рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃАрЃљрЃЊ | рЃЏрЃћрЃЦрЃљрЃюрЃўрЃЎрЃБрЃарЃў |

## 7. рЃбрЃћрЃЦрЃюрЃўрЃЎрЃБрЃарЃў рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃўрЃА рЃЊрЃћрЃбрЃљрЃџрЃћрЃЉрЃў

- **рЃЊрЃарЃљрЃўрЃЋрЃћрЃарЃў:** рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ ESP-IDF-рЃўрЃА `ledc` (LED Control) рЃърЃћрЃарЃўрЃцрЃћрЃарЃўрЃљ, рЃцрЃћрЃарЃўрЃАрЃљ рЃЊрЃљ рЃАрЃўрЃЎрЃљрЃерЃЎрЃљрЃерЃўрЃА рЃќрЃБрЃАрЃбрЃў, PWM-рЃќрЃћ рЃЊрЃљрЃцрЃБрЃФрЃюрЃћрЃЉрЃБрЃџрЃў рЃЏрЃљрЃарЃЌрЃЋрЃўрЃАрЃЌрЃЋрЃўрЃА.
- **рЃбрЃљрЃАрЃЎрЃћрЃЉрЃўрЃА рЃЏрЃљрЃарЃЌрЃЋрЃљ:** рЃњрЃљрЃЏрЃЮрЃДрЃЮрЃцрЃўрЃџрЃў FreeRTOS рЃбрЃљрЃАрЃЎрЃў (`led_control_task`) рЃЏрЃљрЃарЃЌрЃљрЃЋрЃА LED-рЃўрЃА рЃЏрЃЊрЃњрЃЮрЃЏрЃљрЃарЃћрЃЮрЃЉрЃћрЃЉрЃўрЃА рЃЏрЃљрЃюрЃЦрЃљрЃюрЃљрЃА рЃЊрЃљ рЃћрЃцрЃћрЃЦрЃбрЃћрЃЉрЃА.
- **рЃАрЃўрЃюрЃЦрЃарЃЮрЃюрЃўрЃќрЃљрЃфрЃўрЃљ:** рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ FreeRTOS `Queue` рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃћрЃЉрЃўрЃА (API рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃўрЃЊрЃљрЃю рЃЊрЃљ CLI-рЃЊрЃљрЃю) `led_control_task`-рЃўрЃАрЃЌрЃЋрЃўрЃА рЃБрЃАрЃљрЃцрЃарЃЌрЃ«рЃЮрЃЊ рЃњрЃљрЃЊрЃљрЃАрЃљрЃфрЃћрЃЏрЃљрЃЊ.

## 8. ­ЪњА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў

рЃгрЃљрЃарЃЏрЃЮрЃЋрЃўрЃЊрЃњрЃўрЃюрЃЮрЃЌ, рЃарЃЮрЃЏ `ota_update_module`-рЃА рЃАрЃБрЃарЃА, рЃљрЃфрЃюрЃЮрЃЉрЃЮрЃА рЃЏрЃЮрЃЏрЃ«рЃЏрЃљрЃарЃћрЃЉрЃћрЃџрЃА рЃњрЃљрЃюрЃљрЃ«рЃџрЃћрЃЉрЃўрЃА рЃърЃарЃЮрЃфрЃћрЃАрЃўрЃА рЃерЃћрЃАрЃљрЃ«рЃћрЃЉ `rgb_led_indicator`-рЃўрЃА рЃЏрЃћрЃерЃЋрЃћрЃЮрЃЉрЃўрЃЌ, рЃарЃЮрЃЏрЃџрЃўрЃА `instance_name` рЃљрЃарЃўрЃА `"status_led"`.

```c
#include "service_locator.h"
#include "rgb_led_interface.h" // рЃўрЃюрЃбрЃћрЃарЃцрЃћрЃўрЃАрЃўрЃА рЃ░рЃћрЃЊрЃћрЃарЃў

// OTA рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃерЃўрЃњрЃюрЃўрЃЌ...
void start_ota_process() {
    // 1. ­Ъџд рЃЋрЃўрЃдрЃћрЃЉрЃЌ LED рЃАрЃћрЃарЃЋрЃўрЃАрЃА Service Locator-рЃўрЃЊрЃљрЃю
    service_handle_t led_service_handle = fmw_service_get("status_led");

    if (!led_service_handle) {
        ESP_LOGW(TAG, "RGB LED Indicator service 'status_led' not found.");
        // рЃњрЃљрЃюрЃљрЃњрЃарЃФрЃћ рЃЏрЃБрЃерЃљрЃЮрЃЉрЃљ LED-рЃўрЃА рЃњрЃљрЃарЃћрЃерЃћ...
        return;
    }

    // 2. ­Ъцќ рЃЋрЃљрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃЌ рЃАрЃћрЃарЃЋрЃўрЃАрЃўрЃА рЃбрЃўрЃърЃА (рЃБрЃАрЃљрЃцрЃарЃЌрЃ«рЃЮрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА)
    fmw_service_type_t service_type;
    if (fmw_service_get_type("status_led", &service_type) != ESP_OK || service_type != FMW_SERVICE_TYPE_RGB_LED_API) {
        ESP_LOGE(TAG, "Service 'status_led' is not a valid RGB LED API.");
        return;
    }

    // 3.  рЃЎрЃљрЃАрЃбрЃўрЃюрЃњрЃўрЃЌ рЃЋрЃўрЃдрЃћрЃЉрЃЌ API-рЃА
    rgb_led_api_t *led_api = (rgb_led_api_t *)led_service_handle;

    // 4. ­ЪњЎ рЃЋрЃўрЃгрЃДрЃћрЃЉрЃЌ "рЃърЃБрЃџрЃАрЃљрЃфрЃўрЃўрЃА" рЃћрЃцрЃћрЃЦрЃбрЃА рЃџрЃБрЃарЃ» рЃцрЃћрЃарЃерЃў, рЃарЃљрЃЌрЃљ рЃЋрЃљрЃЕрЃЋрЃћрЃюрЃЮрЃЌ, рЃарЃЮрЃЏ OTA рЃЏрЃўрЃЏрЃЊрЃўрЃюрЃљрЃарЃћрЃЮрЃЉрЃА
    ESP_LOGI(TAG, "Starting OTA update... Setting LED to pulsing blue.");
    led_api->start_pulse(0, 0, 255, 2000); // рЃџрЃБрЃарЃ»рЃў, 2 рЃгрЃљрЃЏрЃўрЃА рЃърЃћрЃарЃўрЃЮрЃЊрЃўрЃЌ

    // ... рЃЏрЃўрЃЏрЃЊрЃўрЃюрЃљрЃарЃћрЃЮрЃЉрЃА OTA рЃњрЃљрЃюрЃљрЃ«рЃџрЃћрЃЉрЃљ ...

    // 5. РюЁ рЃњрЃљрЃюрЃљрЃ«рЃџрЃћрЃЉрЃљ рЃгрЃљрЃарЃЏрЃљрЃбрЃћрЃЉрЃБрЃџрЃўрЃљ, рЃЋрЃљрЃбрЃДрЃЮрЃЉрЃўрЃюрЃћрЃЉрЃЌ рЃЏрЃЮрЃЏрЃ«рЃЏрЃљрЃарЃћрЃЉрЃћрЃџрЃА
    ESP_LOGI(TAG, "OTA update successful!");
    led_api->set_color(0, 255, 0); // рЃЋрЃљрЃюрЃљрЃЌрЃћрЃЉрЃЌ рЃЏрЃгрЃЋрЃљрЃюрЃћрЃЊ
    vTaskDelay(pdMS_TO_TICKS(3000)); // 3 рЃгрЃљрЃЏрЃў

    // 6. ­Ъћё рЃЋрЃљрЃЉрЃарЃБрЃюрЃћрЃЉрЃЌ LED-рЃА рЃЌрЃљрЃЋрЃўрЃА рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃа рЃарЃћрЃЪрЃўрЃЏрЃерЃў
    ESP_LOGI(TAG, "Releasing LED control.");
    led_api->release_control();
}