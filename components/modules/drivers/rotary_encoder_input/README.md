# ­Ъћў рЃЏрЃЮрЃЊрЃБрЃџрЃў: `rotary_encoder_input`

**­ЪЌѓ№ИЈ рЃЎрЃљрЃбрЃћрЃњрЃЮрЃарЃўрЃљ:** `drivers`  
**Рюњ№ИЈ рЃљрЃЋрЃбрЃЮрЃарЃў:** Synapse Framework Team  
**­Ъћќ рЃЋрЃћрЃарЃАрЃўрЃљ:** 3.0.0

## 1. ­ЪЊю рЃЏрЃўрЃЏрЃЮрЃ«рЃўрЃџрЃЋрЃљ

`rotary_encoder_input` рЃљрЃарЃўрЃА Synapse Framework-рЃўрЃА **рЃБрЃюрЃўрЃЋрЃћрЃарЃАрЃљрЃџрЃБрЃарЃў, рЃЏрЃЮрЃЏрЃ«рЃЏрЃљрЃарЃћрЃЉрЃџрЃўрЃА рЃерЃћрЃбрЃљрЃюрЃўрЃА (User Input) рЃЏрЃЮрЃЊрЃБрЃџрЃў**, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃерЃћрЃЦрЃЏрЃюрЃўрЃџрЃўрЃљ рЃЏрЃЉрЃарЃБрЃюрЃљрЃЋрЃў рЃћрЃюрЃЎрЃЮрЃЊрЃћрЃарЃћрЃЉрЃўрЃА (Rotary Encoders) рЃЊрЃљрЃАрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃџрЃљрЃЊ. рЃЏрЃўрЃАрЃў рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў рЃљрЃЏрЃЮрЃфрЃљрЃюрЃљрЃљ, рЃљрЃўрЃдрЃЮрЃА рЃЊрЃљрЃЉрЃљрЃџрЃў рЃЊрЃЮрЃюрЃўрЃА, рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃў рЃљрЃърЃљрЃарЃљрЃбрЃБрЃарЃБрЃџрЃў рЃАрЃўрЃњрЃюрЃљрЃџрЃћрЃЉрЃў (рЃЉрЃарЃБрЃюрЃЋрЃљ рЃЊрЃљ рЃЊрЃљрЃГрЃћрЃарЃљ) рЃЊрЃљ рЃњрЃљрЃЊрЃљрЃЌрЃљрЃарЃњрЃЏрЃюрЃЮрЃА рЃўрЃАрЃўрЃюрЃў рЃЏрЃљрЃдрЃљрЃџрЃў рЃЊрЃЮрЃюрЃўрЃА, рЃАрЃбрЃљрЃюрЃЊрЃљрЃарЃбрЃБрЃџ, рЃцрЃарЃћрЃўрЃЏрЃЋрЃЮрЃарЃЦрЃўрЃАрЃЌрЃЋрЃўрЃА рЃњрЃљрЃАрЃљрЃњрЃћрЃЉ рЃўрЃЋрЃћрЃюрЃЌрЃћрЃЉрЃљрЃЊ.

рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃАрЃарЃБрЃџрЃљрЃЊ рЃљрЃЉрЃАрЃбрЃарЃљрЃњрЃўрЃарЃћрЃЉрЃА рЃљрЃърЃљрЃарЃљрЃбрЃБрЃарЃБрЃџ рЃЊрЃћрЃбрЃљрЃџрЃћрЃЉрЃА рЃЊрЃљ `Event Bus`-рЃќрЃћ рЃљрЃЦрЃЋрЃћрЃДрЃюрЃћрЃЉрЃА **рЃќрЃБрЃАрЃбрЃљрЃЊ рЃўрЃњрЃўрЃЋрЃћ** `SYNAPSE_EVENT_BUTTON_PRESSED` рЃўрЃЋрЃћрЃюрЃЌрЃћрЃЉрЃА, рЃарЃљрЃАрЃљрЃф `button_input` рЃЏрЃЮрЃЊрЃБрЃџрЃў. рЃћрЃА рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃБрЃџрЃў рЃњрЃљрЃЊрЃљрЃгрЃДрЃЋрЃћрЃбрЃўрЃџрЃћрЃЉрЃљ рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃљрЃА рЃљрЃФрЃџрЃћрЃЋрЃА `ui_manager`-рЃА рЃЊрЃљ рЃАрЃ«рЃЋрЃљ рЃЏрЃЮрЃЊрЃБрЃџрЃћрЃЉрЃА, рЃБрЃЏрЃбрЃЎрЃўрЃЋрЃюрЃћрЃБрЃџрЃЮрЃЊ рЃЊрЃљ рЃДрЃЮрЃЋрЃћрЃџрЃњрЃЋрЃљрЃарЃў рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃўрЃА рЃњрЃљрЃарЃћрЃерЃћ рЃўрЃЏрЃБрЃерЃљрЃЮрЃю рЃћрЃюрЃЎрЃЮрЃЊрЃћрЃарЃЌрЃљрЃю, рЃЌрЃўрЃЌрЃЦрЃЮрЃА рЃўрЃА рЃЕрЃЋрЃћрЃБрЃџрЃћрЃЉрЃарЃўрЃЋрЃў `UP`/`DOWN`/`OK` рЃдрЃўрЃџрЃљрЃЎрЃћрЃЉрЃўрЃА рЃюрЃљрЃЎрЃарЃћрЃЉрЃў рЃўрЃДрЃЮрЃА.

## 2. ­ЪЈЏ№ИЈ рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃБрЃџрЃў рЃърЃарЃўрЃюрЃфрЃўрЃърЃћрЃЉрЃў

- **рЃарЃћрЃАрЃБрЃарЃАрЃћрЃЉрЃўрЃА рЃЮрЃърЃбрЃўрЃЏрЃўрЃќрЃљрЃфрЃўрЃљ:** рЃЏрЃЮрЃЊрЃБрЃџрЃў **рЃљрЃа рЃЦрЃЏрЃюрЃўрЃА рЃАрЃљрЃЎрЃБрЃЌрЃљрЃа рЃбрЃљрЃАрЃЎрЃА**. рЃљрЃЏрЃўрЃА рЃюрЃљрЃфрЃЋрЃџрЃљрЃЊ, рЃўрЃА рЃЌрЃљрЃЋрЃўрЃА рЃърЃћрЃарЃўрЃЮрЃЊрЃБрЃџ рЃгрЃљрЃЎрЃўрЃЌрЃ«рЃЋрЃўрЃА рЃџрЃЮрЃњрЃўрЃЎрЃљрЃА рЃљрЃарЃћрЃњрЃўрЃАрЃбрЃарЃўрЃарЃћрЃЉрЃА `core`-рЃўрЃА **`Task Pool Manager`**-рЃерЃў, рЃарЃЮрЃњрЃЮрЃарЃф "рЃЊрЃљрЃЋрЃљрЃџрЃћрЃЉрЃљ" (`Job`). рЃћрЃА рЃЏрЃўрЃЊрЃњрЃЮрЃЏрЃљ рЃќрЃЮрЃњрЃљрЃЋрЃА ~3KB рЃЮрЃърЃћрЃарЃљрЃбрЃўрЃБрЃџ рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃљрЃА рЃЊрЃљ рЃљрЃЏрЃфрЃўрЃарЃћрЃЉрЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃАрЃљрЃћрЃарЃЌрЃЮ рЃЊрЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃљрЃА.
- **рЃЮрЃарЃЏрЃљрЃњрЃў рЃарЃћрЃЪрЃўрЃЏрЃў (Dual Mode):** РџЎ№ИЈ рЃЏрЃЮрЃЊрЃБрЃџрЃА рЃерЃћрЃБрЃФрЃџрЃўрЃљ рЃўрЃЏрЃБрЃерЃљрЃЮрЃА рЃЮрЃа, рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃЌ рЃЏрЃљрЃарЃЌрЃЋрЃљрЃЊ рЃарЃћрЃЪрЃўрЃЏрЃерЃў:
  1. **`GPIO` рЃарЃћрЃЪрЃўрЃЏрЃў:** рЃћрЃюрЃЎрЃЮрЃЊрЃћрЃарЃў рЃЏрЃўрЃћрЃарЃЌрЃћрЃЉрЃБрЃџрЃўрЃљ рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа ESP32-рЃўрЃА GPIO рЃърЃўрЃюрЃћрЃЉрЃќрЃћ.
  2. **`Expander` рЃарЃћрЃЪрЃўрЃЏрЃў:** рЃћрЃюрЃЎрЃЮрЃЊрЃћрЃарЃў рЃЏрЃўрЃћрЃарЃЌрЃћрЃЉрЃБрЃџрЃўрЃљ `MCP23017` I/O рЃњрЃљрЃЏрЃцрЃљрЃарЃЌрЃЮрЃћрЃЉрЃћрЃџрЃќрЃћ.
- **Event Producer:** ­ЪЊб рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃљрЃарЃўрЃА рЃАрЃБрЃцрЃЌрЃљ "рЃўрЃЋрЃћрЃюрЃЌрЃћрЃЉрЃўрЃА рЃЏрЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃћрЃџрЃў". рЃЏрЃўрЃАрЃў рЃћрЃарЃЌрЃљрЃЊрЃћрЃарЃЌрЃў рЃњрЃљрЃЏрЃЮрЃЏрЃљрЃЋрЃљрЃџрЃў рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃў рЃљрЃарЃўрЃА `SYNAPSE_EVENT_BUTTON_PRESSED` рЃўрЃЋрЃћрЃюрЃЌрЃў.
- **рЃЏрЃЊрЃњрЃЮрЃЏрЃљрЃарЃћрЃЮрЃЉрЃўрЃА рЃЏрЃљрЃюрЃЦрЃљрЃюрЃљ (State Machine):** ­ЪДа рЃЉрЃарЃБрЃюрЃЋрЃўрЃА рЃЏрЃўрЃЏрЃљрЃарЃЌрЃБрЃџрЃћрЃЉрЃўрЃА рЃќрЃБрЃАрЃбрЃљрЃЊ рЃЊрЃљрЃАрЃљрЃЊрЃњрЃћрЃюрЃљрЃЊ, рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃўрЃДрЃћрЃюрЃћрЃЉрЃА рЃАрЃарЃБрЃџ рЃЎрЃЋрЃљрЃЊрЃарЃљрЃбрЃБрЃарЃБрЃџ рЃЊрЃћрЃЎрЃЮрЃЊрЃўрЃарЃћрЃЉрЃўрЃА рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃА, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃЏрЃЊрЃњрЃарЃљрЃЊрЃўрЃљ рЃЋрЃўрЃЉрЃарЃљрЃфрЃўрЃўрЃАрЃљ рЃЊрЃљ "рЃгрЃарЃўрЃърЃўрЃюрЃўрЃА" рЃЏрЃўрЃЏрЃљрЃарЃЌ.
- **Debouncing:** ­ЪЏА№ИЈ рЃћрЃюрЃЎрЃЮрЃЊрЃћрЃарЃўрЃА рЃдрЃўрЃџрЃљрЃЎрЃА рЃљрЃЦрЃЋрЃА рЃЕрЃљрЃерЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃАрЃљрЃўрЃЏрЃћрЃЊрЃЮ, рЃЊрЃарЃЮрЃќрЃћ рЃЊрЃљрЃцрЃБрЃФрЃюрЃћрЃЉрЃБрЃџрЃў Debouncing рЃЏрЃћрЃЦрЃљрЃюрЃўрЃќрЃЏрЃў.
- **рЃарЃћрЃАрЃБрЃарЃАрЃћрЃЉрЃўрЃА рЃЏрЃљрЃарЃЌрЃЋрЃљ:** `GPIO` рЃарЃћрЃЪрЃўрЃЏрЃерЃў, рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃўрЃДрЃћрЃюрЃћрЃЉрЃА `Resource Manager`-рЃА рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃАрЃў рЃърЃўрЃюрЃћрЃЉрЃўрЃА рЃћрЃЦрЃАрЃЎрЃџрЃБрЃќрЃўрЃБрЃарЃљрЃЊ рЃЊрЃљрЃАрЃљрЃЎрЃљрЃЋрЃћрЃЉрЃџрЃљрЃЊ.

## 3. РџЎ№ИЈ рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ (`config.json`)

рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃЦрЃфрЃћрЃЋрЃљ рЃЊрЃљ рЃарЃћрЃЪрЃўрЃЏрЃў рЃАрЃарЃБрЃџрЃљрЃЊ рЃўрЃЏрЃљрЃарЃЌрЃћрЃЉрЃљ `config.json` рЃцрЃљрЃўрЃџрЃўрЃЊрЃљрЃю.

### 3.1. рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ `GPIO` рЃарЃћрЃЪрЃўрЃЏрЃўрЃАрЃЌрЃЋрЃўрЃА

```json
[
  {
    "type": "rotary_encoder_input",
    "enabled": true,
    "config": {
      "instance_name": "main_rotary_encoder",
      "control_type": "gpio",
      "pin_a": 32,
      "pin_b": 33,
      "pin_sw": 25,
      "button_name": "OK",
      "active_level": 0,
      "polling_interval_ms": 20
    }
  }
]
```

### 3.2. рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ `Expander` рЃарЃћрЃЪрЃўрЃЏрЃўрЃАрЃЌрЃЋрЃўрЃА

```json
[
  {
    "type": "rotary_encoder_input",
    "enabled": true,
    "config": {
      "instance_name": "main_rotary_encoder",
      "control_type": "expander",
      "expander_service": "main_io_expander",
      "pin_a": 10,
      "pin_b": 11,
      "pin_sw": 12,
      "button_name": "OK",
      "active_level": 0,
      "polling_interval_ms": 20
    }
  }
]
```

### 3.3. рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў

| рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў | рЃбрЃўрЃърЃў | рЃљрЃдрЃгрЃћрЃарЃљ | рЃАрЃљрЃЋрЃљрЃџрЃЊрЃћрЃЉрЃБрЃџрЃЮ | Default |
| :--- | :--- | :--- | :---: | :--- |
| `instance_name` | рЃАрЃбрЃарЃўрЃЦрЃЮрЃюрЃў | рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃБрЃюрЃўрЃЎрЃљрЃџрЃБрЃарЃў рЃАрЃљрЃ«рЃћрЃџрЃў. | РюЁ | - |
| `control_type` | рЃАрЃбрЃарЃўрЃЦрЃЮрЃюрЃў | рЃЏрЃБрЃерЃљрЃЮрЃЉрЃўрЃА рЃарЃћрЃЪрЃўрЃЏрЃў: `"gpio"` рЃљрЃю `"expander"`. | РЮї | `"gpio"` |
| `expander_service` | рЃАрЃбрЃарЃўрЃЦрЃЮрЃюрЃў | рЃўрЃЏ `mcp23017_io_expander` рЃАрЃћрЃарЃЋрЃўрЃАрЃўрЃА рЃАрЃљрЃ«рЃћрЃџрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃБрЃюрЃЊрЃљ рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃЮрЃА. | `expander` рЃарЃћрЃЪрЃўрЃЏрЃўрЃАрЃЌрЃЋрЃўрЃА |
| `pin_a` | рЃарЃўрЃфрЃ«рЃЋрЃў | рЃћрЃюрЃЎрЃЮрЃЊрЃћрЃарЃўрЃА `A` (CLK) рЃърЃўрЃюрЃўрЃА рЃюрЃЮрЃЏрЃћрЃарЃў. | РюЁ | - |
| `pin_b` | рЃарЃўрЃфрЃ«рЃЋрЃў | рЃћрЃюрЃЎрЃЮрЃЊрЃћрЃарЃўрЃА `B` (DT) рЃърЃўрЃюрЃўрЃА рЃюрЃЮрЃЏрЃћрЃарЃў. | РюЁ | - |
| `pin_sw` | рЃарЃўрЃфрЃ«рЃЋрЃў | рЃћрЃюрЃЎрЃЮрЃЊрЃћрЃарЃўрЃА рЃдрЃўрЃџрЃљрЃЎрЃўрЃА (`SW`) рЃърЃўрЃюрЃўрЃА рЃюрЃЮрЃЏрЃћрЃарЃў. | РюЁ | - |
| `button_name` | рЃАрЃбрЃарЃўрЃЦрЃЮрЃюрЃў | рЃАрЃљрЃ«рЃћрЃџрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃњрЃљрЃўрЃњрЃќрЃљрЃЋрЃюрЃћрЃЉрЃљ рЃдрЃўрЃџрЃљрЃЎрЃќрЃћ рЃЊрЃљрЃГрЃћрЃарЃўрЃАрЃљрЃА. | РЮї | `"OK"` |
| `active_level` | рЃарЃўрЃфрЃ«рЃЋрЃў | рЃџрЃЮрЃњрЃўрЃЎрЃБрЃарЃў рЃЊрЃЮрЃюрЃћ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃЊрЃљрЃГрЃћрЃарЃўрЃџ рЃЏрЃЊрЃњрЃЮрЃЏрЃљрЃарЃћрЃЮрЃЉрЃљрЃЊ рЃўрЃЌрЃЋрЃџрЃћрЃЉрЃљ (`0`=LOW, `1`=HIGH). | РЮї | `0` |
| `polling_interval_ms` | рЃарЃўрЃфрЃ«рЃЋрЃў | рЃърЃўрЃюрЃћрЃЉрЃўрЃА рЃгрЃљрЃЎрЃўрЃЌрЃ«рЃЋрЃўрЃА рЃўрЃюрЃбрЃћрЃарЃЋрЃљрЃџрЃў рЃЏрЃўрЃџрЃўрЃгрЃљрЃЏрЃћрЃЉрЃерЃў. | РЮї | `20` (Kconfig-рЃўрЃЊрЃљрЃю) |

## 4. ­ЪЊб рЃњрЃљрЃЏрЃЮрЃЦрЃЋрЃћрЃДрЃюрЃћрЃЉрЃБрЃџрЃў рЃўрЃЋрЃћрЃюрЃЌрЃћрЃЉрЃў

рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃљрЃЦрЃЋрЃћрЃДрЃюрЃћрЃЉрЃА рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃћрЃарЃЌ, рЃАрЃбрЃљрЃюрЃЊрЃљрЃарЃбрЃБрЃџ рЃўрЃЋрЃћрЃюрЃЌрЃА, рЃЏрЃљрЃњрЃарЃљрЃЏ рЃњрЃљрЃюрЃАрЃ«рЃЋрЃљрЃЋрЃћрЃЉрЃБрЃџрЃў `payload`-рЃўрЃЌ, рЃарЃљрЃф рЃБрЃќрЃарЃБрЃюрЃЋрЃћрЃџрЃДрЃЮрЃцрЃА `ui_manager`-рЃЌрЃљрЃю рЃАрЃарЃБрЃџ рЃЌрЃљрЃЋрЃАрЃћрЃЉрЃљрЃЊрЃЮрЃЉрЃљрЃА.

| рЃцрЃўрЃќрЃўрЃЎрЃБрЃарЃў рЃЏрЃЮрЃЦрЃЏрЃћрЃЊрЃћрЃЉрЃљ | рЃўрЃЋрЃћрЃюрЃЌрЃўрЃА рЃАрЃљрЃ«рЃћрЃџрЃў | Payload (`button_name`) |
| :--- | :--- | :--- |
| **рЃЉрЃарЃБрЃюрЃЋрЃљ рЃАрЃљрЃљрЃЌрЃўрЃА рЃўрЃАрЃарЃўрЃА рЃЏрЃўрЃЏрЃљрЃарЃЌрЃБрЃџрЃћрЃЉрЃўрЃЌ (CW)** | `SYNAPSE_EVENT_BUTTON_PRESSED` | `"DOWN"` |
| **рЃЉрЃарЃБрЃюрЃЋрЃљ рЃАрЃљрЃљрЃЌрЃўрЃА рЃўрЃАрЃарЃўрЃА рЃАрЃљрЃгрЃўрЃюрЃљрЃљрЃдрЃЏрЃЊрЃћрЃњрЃЮрЃЊ (CCW)** | `SYNAPSE_EVENT_BUTTON_PRESSED` | `"UP"` |
| **рЃдрЃўрЃџрЃљрЃЎрЃќрЃћ рЃЊрЃљрЃГрЃћрЃарЃљ** | `SYNAPSE_EVENT_BUTTON_PRESSED` | `"OK"` (рЃљрЃю рЃарЃљрЃф рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃБрЃџрЃўрЃљ `button_name`-рЃерЃў) |

**Payload-рЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ:**

```c
// synapse_button_payload_t payload;
// snprintf(payload.button_name, sizeof(payload.button_name), "UP");
```

## 5. ­Ъћї рЃЏрЃўрЃћрЃарЃЌрЃћрЃЉрЃўрЃА рЃАрЃЦрЃћрЃЏрЃљ

рЃћрЃюрЃЎрЃЮрЃЊрЃћрЃарЃўрЃА рЃърЃўрЃюрЃћрЃЉрЃўрЃА рЃЏрЃљрЃарЃЎрЃўрЃарЃћрЃЉрЃљ (`S1`, `S2`, `KEY`) рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа рЃерЃћрЃћрЃАрЃљрЃЉрЃљрЃЏрЃћрЃЉрЃљ рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃА.

- **`S1`** (рЃљрЃю **CLK**) Рєћ№ИЈ **`pin_a`**
- **`S2`** (рЃљрЃю **DT**) Рєћ№ИЈ **`pin_b`**
- **`KEY`** (рЃљрЃю **SW**) Рєћ№ИЈ **`pin_sw`**

рЃЮрЃарЃўрЃЋрЃћ рЃарЃћрЃЪрЃўрЃЏрЃерЃў, `active_level: 0` рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃАрЃЌрЃЋрЃўрЃА, рЃдрЃўрЃџрЃљрЃЎрЃў рЃЊрЃљ рЃћрЃюрЃЎрЃЮрЃЊрЃћрЃарЃўрЃА рЃњрЃљрЃЏрЃЮрЃЏрЃљрЃЋрЃљрЃџрЃў рЃърЃўрЃюрЃћрЃЉрЃў рЃБрЃюрЃЊрЃљ рЃерЃћрЃћрЃарЃЌрЃЊрЃћрЃА **рЃърЃўрЃюрЃАрЃљ** рЃЊрЃљ **GND**-рЃА рЃерЃЮрЃарЃўрЃА. рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃарЃЌрЃљрЃЋрЃА рЃерЃўрЃЊрЃљ pull-up рЃарЃћрЃќрЃўрЃАрЃбрЃЮрЃарЃћрЃЉрЃА.

**рЃДрЃБрЃарЃљрЃЊрЃдрЃћрЃЉрЃљ:** ESP32-рЃўрЃА рЃќрЃЮрЃњрЃўрЃћрЃарЃЌ рЃърЃўрЃюрЃА (рЃЏрЃљрЃњ., GPIO 34, 35) рЃљрЃа рЃњрЃљрЃљрЃЕрЃюрЃўрЃљ рЃерЃўрЃЊрЃљ pull-up рЃарЃћрЃќрЃўрЃАрЃбрЃЮрЃарЃћрЃЉрЃў. рЃљрЃЏ рЃърЃўрЃюрЃћрЃЉрЃўрЃА `GPIO` рЃарЃћрЃЪрЃўрЃЏрЃерЃў рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃАрЃљрЃА, рЃљрЃБрЃфрЃўрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ **рЃњрЃљрЃарЃћ 10k╬Е Pull-up рЃарЃћрЃќрЃўрЃАрЃбрЃЮрЃарЃўрЃА** рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃљ.

## 6. ­ЪњА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў (`ui_manager`-рЃЌрЃљрЃю)

рЃљрЃЏ рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃА рЃАрЃўрЃџрЃљрЃЏрЃљрЃќрЃћ рЃўрЃАрЃљрЃљ, рЃарЃЮрЃЏ **`ui_manager`-рЃўрЃА рЃЎрЃЮрЃЊрЃерЃў рЃљрЃарЃљрЃюрЃљрЃўрЃарЃў рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃљ рЃљрЃа рЃљрЃарЃўрЃА рЃАрЃљрЃГрЃўрЃарЃЮ!**

`ui_manager`-рЃўрЃА рЃўрЃЋрЃћрЃюрЃЌрЃћрЃЉрЃўрЃА рЃЊрЃљрЃЏрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃћрЃџрЃў (`ui_events.c`) рЃБрЃЎрЃЋрЃћ рЃБрЃАрЃЏрЃћрЃюрЃА `SYNAPSE_EVENT_BUTTON_PRESSED` рЃўрЃЋрЃћрЃюрЃЌрЃА рЃЊрЃљ рЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃА `"UP"`, `"DOWN"` рЃЊрЃљ `"OK"` `payload`-рЃћрЃЉрЃА.

```c
// рЃюрЃљрЃгрЃДрЃЋрЃћрЃбрЃў ui_events.c-рЃЊрЃљрЃю (рЃљрЃа рЃАрЃљрЃГрЃўрЃарЃЮрЃћрЃЉрЃА рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃљрЃА)
void ui_events_handle(module_t *self, const char *event_name, void *event_data)
{
    // ...
    if (strcmp(event_name, SYNAPSE_EVENT_BUTTON_PRESSED) == 0)
    {
        // ...
        const char *button_name = ((synapse_button_payload_t *)wrapper->payload)->button_name;

        // рЃћрЃА рЃџрЃЮрЃњрЃўрЃЎрЃљ рЃўрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃА рЃарЃЮрЃњрЃЮрЃарЃф button_input-рЃўрЃАрЃЌрЃЋрЃўрЃА, рЃўрЃАрЃћ rotary_encoder_input-рЃўрЃАрЃЌрЃЋрЃўрЃА!
        if (private_data->current_state == UI_STATE_HOME) {
            if (strcmp(button_name, "OK") == 0) {
                // ... рЃњрЃљрЃЊрЃљрЃЊрЃў рЃЏрЃћрЃюрЃўрЃБрЃерЃў ...
            }
        } else {
            // ui_menu_handle_navigation рЃњрЃљрЃЏрЃЮрЃўрЃФрЃљрЃ«рЃћрЃЉрЃА рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃА рЃЏрЃЮрЃЦрЃЏрЃћрЃЊрЃћрЃЉрЃљрЃА
            // "UP", "DOWN" рЃљрЃю "OK" рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃћрЃЉрЃќрЃћ.
            ui_menu_handle_navigation(private_data, button_name);
        }
        // ...
    }
    // ...
}
```
