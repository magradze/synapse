# рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ (System Configuration)

## ­Ъј» рЃЏрЃўрЃќрЃљрЃюрЃў

рЃћрЃА рЃАрЃљрЃ«рЃћрЃџрЃЏрЃФрЃдрЃЋрЃљрЃюрЃћрЃџрЃЮ рЃЊрЃљрЃњрЃћрЃ«рЃЏрЃљрЃарЃћрЃЉрЃљрЃЌ рЃАрЃгрЃЮрЃарЃљрЃЊ рЃЊрЃљ рЃАрЃбрЃљрЃюрЃЊрЃљрЃарЃбрЃБрЃџрЃљрЃЊ рЃљрЃдрЃгрЃћрЃарЃЮрЃЌ рЃЊрЃљ рЃЏрЃљрЃарЃЌрЃЮрЃЌ рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃЊрЃљ рЃЏрЃЮрЃЊрЃБрЃџрЃћрЃЉрЃўрЃА runtime рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ Synapse Framework-рЃерЃў. v5.0.0-рЃЊрЃљрЃю рЃцрЃарЃћрЃўрЃЏрЃЋрЃЮрЃарЃЦрЃў рЃўрЃДрЃћрЃюрЃћрЃЉрЃА **рЃЊрЃћрЃфрЃћрЃюрЃбрЃарЃљрЃџрЃўрЃќрЃћрЃЉрЃБрЃџ** рЃЏрЃЮрЃЊрЃћрЃџрЃА, рЃАрЃљрЃЊрЃљрЃф рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃЏрЃЮрЃЊрЃБрЃџрЃў рЃърЃљрЃАрЃБрЃ«рЃўрЃАрЃЏрЃњрЃћрЃЉрЃћрЃџрЃўрЃљ рЃЌрЃљрЃЋрЃўрЃА default рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљрЃќрЃћ.

---

## 1. рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃцрЃљрЃўрЃџрЃћрЃЉрЃўрЃА рЃарЃЮрЃџрЃћрЃЉрЃў

- **`Kconfig`:** рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃљрЃЋрЃА, рЃарЃЮрЃЏрЃћрЃџрЃў рЃЏрЃЮрЃЊрЃБрЃџрЃћрЃЉрЃўрЃА рЃЎрЃЮрЃЊрЃў рЃЏрЃЮрЃ«рЃЋрЃЊрЃћрЃЉрЃљ firmware-рЃерЃў. рЃћрЃА рЃљрЃарЃўрЃА **build-рЃЊрЃарЃЮрЃўрЃА** рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ.
- **`configs/system_config.json`:** рЃЉрЃљрЃќрЃўрЃАрЃБрЃарЃў рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ. рЃерЃћрЃўрЃфрЃљрЃЋрЃА рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃњрЃџрЃЮрЃЉрЃљрЃџрЃБрЃа рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃА (`firmware`, `global_config`) рЃЊрЃљ **рЃфрЃљрЃарЃўрЃћрЃџ `modules` рЃЏрЃљрЃАрЃўрЃЋрЃА**.
- **`{module_name}/config.json`:** рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА **default runtime рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ**. рЃћрЃА рЃљрЃарЃўрЃА рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў рЃљрЃЊрЃњрЃўрЃџрЃў, рЃАрЃљрЃЊрЃљрЃф рЃБрЃюрЃЊрЃљ рЃљрЃдрЃгрЃћрЃарЃЮрЃЌ рЃЌрЃЦрЃЋрЃћрЃюрЃў рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў.

---

## 2. `config.json`-рЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ рЃЊрЃљ рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃћрЃЉрЃў

рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА `config.json` рЃцрЃљрЃўрЃџрЃў рЃБрЃюрЃЊрЃљ рЃерЃћрЃўрЃфрЃљрЃЋрЃЊрЃћрЃА JSON рЃЏрЃљрЃАрЃўрЃЋрЃА, рЃарЃЮрЃЏрЃџрЃўрЃА рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃћрЃџрЃћрЃЏрЃћрЃюрЃбрЃў рЃљрЃарЃўрЃА рЃЮрЃЉрЃўрЃћрЃЦрЃбрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃљрЃдрЃгрЃћрЃарЃА рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃћрЃарЃЌ рЃўрЃюрЃАрЃбрЃљрЃюрЃфрЃўрЃљрЃА.

**`relay_actuator/config.json` (рЃЮрЃарЃў рЃўрЃюрЃАрЃбрЃљрЃюрЃфрЃўрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў):**

```json
[
  {
    "type": "relay_actuator",
    "enabled": true,
    "config": {
        "instance_name": "main_light",
        "pin": 23
    }
  },
  {
    "type": "relay_actuator",
    "enabled": true,
    "config": {
        "instance_name": "water_pump",
        "pin": 22
    }
  }
]
```

**`mqtt_manager/config.json` (рЃћрЃарЃЌрЃў рЃўрЃюрЃАрЃбрЃљрЃюрЃфрЃўрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў):**

```json
[
  {
    "type": "mqtt_manager",
    "enabled": true,
    "config": {
        "instance_name": "main_broker",
        "broker_uri": "mqtt://192.168.1.100:1883"
    }
  }
]
```

---

## 3. рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃЮрЃЉрЃўрЃћрЃЦрЃбрЃўрЃА рЃљрЃдрЃгрЃћрЃарЃљ

- **`type`:** рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃбрЃўрЃърЃў. рЃћрЃА рЃАрЃбрЃарЃўрЃЦрЃЮрЃюрЃў **рЃќрЃБрЃАрЃбрЃљрЃЊ рЃБрЃюрЃЊрЃљ рЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЮрЃЊрЃћрЃА** рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА `module.json` рЃцрЃљрЃўрЃџрЃерЃў рЃљрЃарЃАрЃћрЃЉрЃБрЃџ `name` рЃЋрЃћрЃџрЃА.
- **`enabled`:** `true` рЃљрЃю `false`. рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃљрЃЋрЃА, рЃБрЃюрЃЊрЃљ рЃњрЃљрЃБрЃерЃЋрЃљрЃА рЃЌрЃБ рЃљрЃарЃљ `System Manager`-рЃЏрЃљ рЃљрЃЏ рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА `init` рЃЊрЃљ `start` рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў. рЃћрЃА рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃљрЃА рЃњрЃљрЃФрЃџрЃћрЃЋрЃЌ, firmware-рЃерЃў рЃњрЃЦрЃЮрЃюрЃЊрЃћрЃЌ рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃЎрЃЮрЃЊрЃў, рЃЏрЃљрЃњрЃарЃљрЃЏ runtime-рЃерЃў рЃњрЃљрЃЏрЃЮрЃарЃЌрЃЮрЃЌ рЃўрЃА.
- **`config`:** рЃЮрЃЉрЃўрЃћрЃЦрЃбрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃерЃћрЃўрЃфрЃљрЃЋрЃА рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃАрЃърЃћрЃфрЃўрЃцрЃўрЃЎрЃБрЃа рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃА.
- **`instance_name`:** `config` рЃЮрЃЉрЃўрЃћрЃЦрЃбрЃўрЃА рЃерЃўрЃњрЃюрЃўрЃЌ рЃљрЃарЃАрЃћрЃЉрЃБрЃџрЃў **рЃБрЃюрЃўрЃЎрЃљрЃџрЃБрЃарЃў** рЃАрЃљрЃ«рЃћрЃџрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃљрЃЏ рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃЎрЃЮрЃюрЃЎрЃарЃћрЃбрЃБрЃџ рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃА (instance) рЃљрЃдрЃюрЃўрЃерЃюрЃљрЃЋрЃА.

---

## 4. рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃќрЃћ рЃгрЃЋрЃЊрЃЮрЃЏрЃљ рЃЎрЃЮрЃЊрЃўрЃЊрЃљрЃю (Dot-Notation)

рЃЏрЃўрЃБрЃ«рЃћрЃЊрЃљрЃЋрЃљрЃЊ рЃЊрЃћрЃфрЃћрЃюрЃбрЃарЃљрЃџрЃўрЃќрЃљрЃфрЃўрЃўрЃАрЃљ, `Config Manager` runtime-рЃерЃў рЃљрЃгрЃДрЃЮрЃЉрЃА рЃћрЃарЃЌрЃўрЃљрЃю рЃџрЃЮрЃњрЃўрЃЎрЃБрЃа рЃ«рЃћрЃА, рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃќрЃћ рЃгрЃЋрЃЊрЃЮрЃЏрЃўрЃА API рЃБрЃфрЃЋрЃџрЃћрЃџрЃў рЃарЃЕрЃћрЃЉрЃљ.

- **рЃњрЃџрЃЮрЃЉрЃљрЃџрЃБрЃарЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃўрЃАрЃЌрЃЋрЃўрЃА:** `"global_config.parameter_name"`
- **рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃўрЃАрЃЌрЃЋрЃўрЃА:** `"instance_name.parameter_name"`

**рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў:**

```c
// рЃњрЃџрЃЮрЃЉрЃљрЃџрЃБрЃарЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃўрЃА рЃгрЃљрЃЎрЃўрЃЌрЃ«рЃЋрЃљ
char device_prefix[32];
esp_err_t ret = fmw_config_get_string("global_config.device.id.prefix", device_prefix, sizeof(device_prefix));
if (ret != ESP_OK) {
    // Handle error, use a default value
}

// `main_broker` рЃўрЃюрЃАрЃбрЃљрЃюрЃфрЃўрЃўрЃА `broker_uri` рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃўрЃА рЃгрЃљрЃЎрЃўрЃЌрЃ«рЃЋрЃљ
char broker_uri[128];
ret = fmw_config_get_string("main_broker.broker_uri", broker_uri, sizeof(broker_uri));
if (ret != ESP_OK) {
    // Handle error
}
```

---

## 5. рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃЋрЃљрЃџрЃўрЃЊрЃљрЃфрЃўрЃљ рЃЊрЃљ Default-рЃћрЃЉрЃў

- **`_create` рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ:** рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА `_create` рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ рЃърЃљрЃАрЃБрЃ«рЃўрЃАрЃЏрЃњрЃћрЃЉрЃћрЃџрЃўрЃљ, рЃгрЃљрЃўрЃЎрЃўрЃЌрЃ«рЃЮрЃА рЃЊрЃљ рЃЊрЃљрЃљрЃЋрЃљрЃџрЃўрЃЊрЃўрЃарЃЮрЃА рЃЌрЃљрЃЋрЃўрЃАрЃў рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃљ.
- **Default рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃћрЃЉрЃў:** рЃЌрЃБ `config.json`-рЃерЃў рЃарЃЮрЃЏрЃћрЃџрЃўрЃЏрЃћ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў рЃљрЃа рЃљрЃарЃўрЃА, рЃЏрЃЮрЃЊрЃБрЃџрЃЏрЃљ рЃБрЃюрЃЊрЃљ рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃЮрЃА `Kconfig`-рЃерЃў рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃБрЃџрЃў рЃљрЃю рЃЎрЃЮрЃЊрЃерЃў рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃБрЃџрЃў рЃБрЃАрЃљрЃцрЃарЃЌрЃ«рЃЮ default рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ.
- **рЃџрЃЮрЃњрЃўрЃарЃћрЃЉрЃљ:** рЃДрЃЋрЃћрЃџрЃљ рЃерЃћрЃфрЃЊрЃЮрЃЏрЃљ (рЃЏрЃљрЃњ., рЃАрЃљрЃЋрЃљрЃџрЃЊрЃћрЃЉрЃБрЃџрЃЮ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃўрЃА рЃљрЃарЃљрЃарЃАрЃћрЃЉрЃЮрЃЉрЃљ) рЃЊрЃљ рЃњрЃљрЃцрЃарЃЌрЃ«рЃўрЃџрЃћрЃЉрЃљ (рЃЏрЃљрЃњ., default рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљ) рЃБрЃюрЃЊрЃљ рЃЊрЃљрЃўрЃџрЃЮрЃњрЃЮрЃА.

---

## 6. рЃАрЃљрЃБрЃЎрЃћрЃЌрЃћрЃАрЃЮ рЃърЃарЃљрЃЦрЃбрЃўрЃЎрЃћрЃЉрЃў (Best Practices)

- **рЃљрЃдрЃгрЃћрЃарЃўрЃЌрЃў рЃАрЃљрЃ«рЃћрЃџрЃћрЃЉрЃў:** рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЌ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃЊрЃћрЃАрЃЎрЃарЃўрЃърЃбрЃўрЃБрЃџрЃў рЃЊрЃљ рЃЎрЃЮрЃюрЃбрЃћрЃЦрЃАрЃбрЃБрЃарЃў рЃАрЃљрЃ«рЃћрЃџрЃћрЃЉрЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА.
- **Hardcoded рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃћрЃЉрЃўрЃА рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃю рЃљрЃарЃўрЃЊрЃћрЃЉрЃљ:** рЃљрЃарЃљрЃАрЃЊрЃарЃЮрЃА рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃЮрЃЌ hardcoded рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃћрЃЉрЃў рЃЎрЃЮрЃЊрЃерЃў. рЃДрЃЋрЃћрЃџрЃљ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў рЃБрЃюрЃЊрЃљ рЃўрЃДрЃЮрЃА `config.json`-рЃерЃў рЃљрЃю `Kconfig`-рЃерЃў.
- **рЃЊрЃЮрЃЎрЃБрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ:** рЃДрЃЋрЃћрЃџрЃљ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў рЃЊрЃћрЃбрЃљрЃџрЃБрЃарЃљрЃЊ рЃљрЃдрЃгрЃћрЃарЃћрЃЌ рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА `README.md` рЃцрЃљрЃўрЃџрЃерЃў.
- **рЃЎрЃЮрЃюрЃЋрЃћрЃюрЃфрЃўрЃћрЃЉрЃўрЃА рЃЊрЃљрЃфрЃЋрЃљ:** рЃЊрЃљрЃўрЃфрЃљрЃЋрЃўрЃЌ рЃърЃарЃЮрЃћрЃЦрЃбрЃерЃў рЃЏрЃўрЃдрЃћрЃЉрЃБрЃџрЃў [рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃЏрЃљрЃарЃЌрЃЋрЃўрЃА](../convention/configuration_management.md) рЃЊрЃљ [рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃўрЃА](../convention/module_structure.md) рЃгрЃћрЃАрЃћрЃЉрЃў.

---

рЃЌрЃБ рЃерЃћрЃњрЃћрЃЦрЃЏрЃюрЃљрЃЌ рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ, рЃўрЃ«рЃўрЃџрЃћрЃЌ [Troubleshooting](../troubleshooting/) рЃЊрЃЮрЃЎрЃБрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ.
