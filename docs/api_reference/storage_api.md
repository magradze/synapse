# ğŸ’¾ Synapse Storage Manager API Reference

## ğŸ¯ áƒ›áƒ˜áƒ–áƒáƒœáƒ˜

áƒ”áƒ¡ áƒ“áƒáƒ™áƒ£áƒ›áƒ”áƒœáƒ¢áƒ˜ áƒáƒ¦áƒ¬áƒ”áƒ áƒ¡ Synapse Framework-áƒ˜áƒ¡ áƒªáƒ”áƒœáƒ¢áƒ áƒáƒšáƒ˜áƒ–áƒ”áƒ‘áƒ£áƒšáƒ˜ **Storage Manager** áƒ¡áƒ”áƒ áƒ•áƒ˜áƒ¡áƒ˜áƒ¡ áƒ¡áƒáƒ¯áƒáƒ áƒ API-áƒ¡. áƒ”áƒ¡ API áƒ£áƒ–áƒ áƒ£áƒœáƒ•áƒ”áƒšáƒ§áƒáƒ¤áƒ¡ áƒ”áƒ áƒ—áƒ˜áƒáƒœ áƒ˜áƒœáƒ¢áƒ”áƒ áƒ¤áƒ”áƒ˜áƒ¡áƒ¡ áƒ¡áƒ®áƒ•áƒáƒ“áƒáƒ¡áƒ®áƒ•áƒ áƒ¤áƒ˜áƒ–áƒ˜áƒ™áƒ£áƒ  áƒ¡áƒáƒªáƒáƒ•áƒ—áƒáƒœ (NVS, SPIFFS, SD Card) áƒ¡áƒáƒ›áƒ£áƒ¨áƒáƒáƒ“, áƒ áƒáƒª áƒ›áƒáƒ“áƒ£áƒšáƒ”áƒ‘áƒ¡ áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ”áƒ‘áƒáƒ¡ áƒáƒ«áƒšáƒ”áƒ•áƒ¡, áƒ¨áƒ”áƒ˜áƒœáƒáƒ®áƒáƒœ áƒ“áƒ áƒ¬áƒáƒ˜áƒ™áƒ˜áƒ—áƒ®áƒáƒœ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ áƒ¨áƒ”áƒœáƒáƒ®áƒ•áƒ˜áƒ¡ áƒ™áƒáƒœáƒ™áƒ áƒ”áƒ¢áƒ£áƒšáƒ˜ áƒ¢áƒ”áƒ¥áƒœáƒáƒšáƒáƒ’áƒ˜áƒ˜áƒ¡ áƒªáƒáƒ“áƒœáƒ˜áƒ¡ áƒ’áƒáƒ áƒ”áƒ¨áƒ”.

áƒ¡áƒ”áƒ áƒ•áƒ˜áƒ¡áƒ˜áƒ¡ áƒ›áƒ˜áƒ¡áƒáƒ¦áƒ”áƒ‘áƒáƒ“ áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒ”áƒ— `synapse_service_get("main_storage")`.

---

## âš™ï¸ API-áƒ¡ áƒ¡áƒ¢áƒ áƒ£áƒ¥áƒ¢áƒ£áƒ áƒ (`storage_api_t`)

áƒ§áƒ•áƒ”áƒšáƒ áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ áƒ®áƒ”áƒšáƒ›áƒ˜áƒ¡áƒáƒ¬áƒ•áƒ“áƒáƒ›áƒ˜áƒ `storage_api_t` áƒ¡áƒ¢áƒ áƒ£áƒ¥áƒ¢áƒ£áƒ áƒ˜áƒ¡ áƒ›áƒáƒ©áƒ•áƒ”áƒœáƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ”áƒ‘áƒ˜áƒ—.

### ğŸ”‘ Key-Value áƒáƒáƒ”áƒ áƒáƒªáƒ˜áƒ”áƒ‘áƒ˜

áƒ”áƒ¡ áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ”áƒ‘áƒ˜ áƒ˜áƒ“áƒ”áƒáƒšáƒ£áƒ áƒ˜áƒ áƒ›áƒªáƒ˜áƒ áƒ” áƒ–áƒáƒ›áƒ˜áƒ¡ áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ£áƒšáƒ˜ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒ¨áƒ”áƒ¡áƒáƒœáƒáƒ®áƒáƒ“.

- **`esp_err_t set_string(const char* owner, const char* key, const char* value);`**  
    áƒ˜áƒœáƒáƒ®áƒáƒ•áƒ¡ áƒ¡áƒ¢áƒ áƒ˜áƒ¥áƒáƒœáƒ¡. `owner` áƒáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ˜ áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ áƒ áƒáƒ’áƒáƒ áƒª namespace (NVS-áƒ—áƒ•áƒ˜áƒ¡) áƒáƒœ áƒ“áƒ˜áƒ áƒ”áƒ¥áƒ¢áƒáƒ áƒ˜áƒ (SPIFFS/SD-áƒ¡áƒ—áƒ•áƒ˜áƒ¡).

- **`esp_err_t get_string(const char* owner, const char* key, char* buffer, size_t* buffer_size);`**  
    áƒ™áƒ˜áƒ—áƒ®áƒ£áƒšáƒáƒ‘áƒ¡ áƒ¨áƒ”áƒœáƒáƒ®áƒ£áƒš áƒ¡áƒ¢áƒ áƒ˜áƒ¥áƒáƒœáƒ¡.

- **`esp_err_t set_i32(const char* owner, const char* key, int32_t value);`**  
    áƒ˜áƒœáƒáƒ®áƒáƒ•áƒ¡ 32-áƒ‘áƒ˜áƒ¢áƒ˜áƒáƒœ áƒ›áƒ—áƒ”áƒš áƒ áƒ˜áƒªáƒ®áƒ•áƒ¡.

- **`esp_err_t get_i32(const char* owner, const char* key, int32_t* out_value);`**  
    áƒ™áƒ˜áƒ—áƒ®áƒ£áƒšáƒáƒ‘áƒ¡ áƒ¨áƒ”áƒœáƒáƒ®áƒ£áƒš 32-áƒ‘áƒ˜áƒ¢áƒ˜áƒáƒœ áƒ áƒ˜áƒªáƒ®áƒ•áƒ¡.

- **`esp_err_t set_bool(const char* owner, const char* key, bool value);`**  
    áƒ˜áƒœáƒáƒ®áƒáƒ•áƒ¡ áƒšáƒáƒ’áƒ˜áƒ™áƒ£áƒ  áƒ›áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒšáƒáƒ‘áƒáƒ¡ (`true`/`false`).

- **`esp_err_t get_bool(const char* owner, const char* key, bool* out_value);`**  
    áƒ™áƒ˜áƒ—áƒ®áƒ£áƒšáƒáƒ‘áƒ¡ áƒ¨áƒ”áƒœáƒáƒ®áƒ£áƒš áƒšáƒáƒ’áƒ˜áƒ™áƒ£áƒ  áƒ›áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒšáƒáƒ‘áƒáƒ¡.

- **`esp_err_t erase_key(const char* owner, const char* key);`**  
    áƒ¨áƒšáƒ˜áƒ¡ áƒ›áƒ˜áƒ—áƒ˜áƒ—áƒ”áƒ‘áƒ£áƒš key-value áƒ¬áƒ§áƒ•áƒ˜áƒšáƒ¡.

---

### ğŸ—‚ï¸ áƒ¤áƒáƒ˜áƒšáƒ£áƒ áƒ˜ áƒáƒáƒ”áƒ áƒáƒªáƒ˜áƒ”áƒ‘áƒ˜

áƒ”áƒ¡ áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ”áƒ‘áƒ˜ áƒ®áƒ”áƒšáƒ›áƒ˜áƒ¡áƒáƒ¬áƒ•áƒ“áƒáƒ›áƒ˜áƒ áƒ›áƒ®áƒáƒšáƒáƒ“ áƒ›áƒáƒ¨áƒ˜áƒœ, áƒ áƒáƒ“áƒ”áƒ¡áƒáƒª `Kconfig`-áƒ¨áƒ˜ áƒáƒ áƒ©áƒ”áƒ£áƒšáƒ˜áƒ **SPIFFS** áƒáƒœ **SD Card** backend-áƒ˜. NVS backend-áƒ˜áƒ¡ áƒ¨áƒ”áƒ›áƒ—áƒ®áƒ•áƒ”áƒ•áƒáƒ¨áƒ˜, áƒ˜áƒ¡áƒ˜áƒœáƒ˜ áƒ“áƒáƒáƒ‘áƒ áƒ£áƒœáƒ”áƒ‘áƒ”áƒœ `ESP_ERR_NOT_SUPPORTED` áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒáƒ¡.

- **`esp_err_t write_file(const char* file_path, const void* data, size_t size);`**  
    áƒ¬áƒ”áƒ áƒ¡ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ¡ áƒ¤áƒáƒ˜áƒšáƒ¨áƒ˜ áƒ›áƒ˜áƒ—áƒ˜áƒ—áƒ”áƒ‘áƒ£áƒš áƒ›áƒ˜áƒ¡áƒáƒ›áƒáƒ áƒ—áƒ–áƒ” (áƒ›áƒáƒ’., `/spiffs/logs/today.log`). áƒ—áƒ£ áƒ¤áƒáƒ˜áƒšáƒ˜ áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡, áƒ’áƒáƒ“áƒáƒáƒ¬áƒ”áƒ áƒ¡.

- **`esp_err_t read_file(const char* file_path, void* buffer, size_t* buffer_size);`**  
    áƒ™áƒ˜áƒ—áƒ®áƒ£áƒšáƒáƒ‘áƒ¡ áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ¡áƒ áƒ£áƒš áƒ¨áƒ˜áƒ’áƒ—áƒáƒ•áƒ¡áƒ¡.

- **`esp_err_t delete_file(const char* file_path);`**  
    áƒ¨áƒšáƒ˜áƒ¡ áƒ›áƒ˜áƒ—áƒ˜áƒ—áƒ”áƒ‘áƒ£áƒš áƒ¤áƒáƒ˜áƒšáƒ¡.

- **`bool file_exists(const char* file_path);`**  
    áƒáƒ›áƒáƒ¬áƒ›áƒ”áƒ‘áƒ¡, áƒáƒ áƒ¡áƒ”áƒ‘áƒáƒ‘áƒ¡ áƒ—áƒ£ áƒáƒ áƒ áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ›áƒ˜áƒ—áƒ˜áƒ—áƒ”áƒ‘áƒ£áƒš áƒ›áƒ˜áƒ¡áƒáƒ›áƒáƒ áƒ—áƒ–áƒ”.

---

## ğŸ’¡ áƒ’áƒáƒ›áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜

```c
#include "service_locator.h"
#include "storage_interface.h"

void example_storage_usage() {
    // 1. áƒ¡áƒ”áƒ áƒ•áƒ˜áƒ¡áƒ˜áƒ¡ áƒ›áƒ˜áƒ¦áƒ”áƒ‘áƒ
    storage_api_t *storage = (storage_api_t *)synapse_service_get("main_storage");
    if (!storage) {
        ESP_LOGE(TAG, "Storage service is not available!");
        return;
    }

    // 2. Key-Value áƒáƒáƒ”áƒ áƒáƒªáƒ˜áƒ
    storage->set_i32("my_app", "boot_count", 42);

    // 3. áƒ¤áƒáƒ˜áƒšáƒ£áƒ áƒ˜ áƒáƒáƒ”áƒ áƒáƒªáƒ˜áƒ (áƒ˜áƒ›áƒ£áƒ¨áƒáƒ•áƒ”áƒ‘áƒ¡ áƒ›áƒ®áƒáƒšáƒáƒ“ SPIFFS/SD-áƒ–áƒ”)
    const char* message = "Hello, Synapse!";
    esp_err_t err = storage->write_file("/spiffs/welcome.txt", message, strlen(message));
    if (err == ESP_ERR_NOT_SUPPORTED) {
        ESP_LOGW(TAG, "File operations are not supported by the current storage backend (NVS).");
    }
}
```

---

áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ—áƒ˜ áƒ“áƒ”áƒ¢áƒáƒšáƒ”áƒ‘áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡ áƒ˜áƒ®áƒ˜áƒšáƒ”áƒ— [storage_manager-áƒ˜áƒ¡ README](../modules/storage/storage_manager/README.md) áƒ“áƒ [storage_interface.h](../interfaces/include/storage_interface.h).
