# 🧪 მოდული `timer_test`

## 1. 📜 მიმოხილვა

**მოდულის სახელი:** `timer_test`  
**კატეგორია:** `testing`  
**ვერსია:** 1.0.0  
**ავტორი:** Synapse Framework Team

`timer_test` არის სატესტო და სადემონსტრაციო მოდული, რომელიც შექმნილია Synapse Framework-ის ორი ძირითადი სერვისის — **`System Timer Service`**-ისა და **`RGB LED Indicator`**-ის — ურთიერთქმედების შესამოწმებლად.

მოდულის მთავარი დანიშნულებაა, აჩვენოს, თუ როგორ შეუძლია ერთ მოდულს, გამოიყენოს ტაიმერის სერვისი პერიოდული მოქმედებების დასაგეგმად და შემდეგ, სხვა სერვისის (ამ შემთხვევაში, LED ინდიკატორის) API გამოიძახოს ამ მოქმედების შესასრულებლად.

**ეს მოდული არ არის განკუთვნილი საბოლოო პროდუქტში გამოსაყენებლად.** ის წარმოადგენს შესანიშნავ მაგალითს და "სავარჯიშოს" ახალი დეველოპერებისთვის, რათა გაეცნონ ფრეიმვორქის ძირითად პრინციპებს.

## 2. 🏗️ არქიტექტურული პრინციპები

- **სერვისის მომხმარებელი (Service Consumer):** ეს მოდული არის კლასიკური სერვისის მომხმარებელი. ის არ აწვდის საკუთარ სერვისს, არამედ იყენებს ორ სხვა სერვისს:
    1. `System Timer Service` (`main_timer_service`)
    2. `RGB LED Indicator` (`status_led`)
- **ივენთებზე-დაფუძნებული ლოგიკა:** მოდული იყენებს `Event Bus`-ს, რათა მიიღოს თავის მიერვე დაგეგმილი ივენთი (`EVT_TOGGLE_LED_COLOR`). ეს აჩვენებს, თუ როგორ შეიძლება ტაიმერის ლოგიკის გამოყოფა რეალური მოქმედებისგან.
- **მაღალი ინიციალიზაციის დონე (`init_level: 80`):** რადგან ის დამოკიდებულია სხვა სერვისებზე, მისი `init_level` მაღალია, რათა დარწმუნებული ვიყოთ, რომ `system_timer` და `rgb_led_indicator` მოდულები უკვე ინიციალიზებული და გაშვებულია, როდესაც `timer_test` იწყებს მუშაობას.

## 3. ⚙️ კონფიგურაცია

მოდული იმართება `Kconfig`-იდან და არ საჭიროებს `system_config.json`-ში კომპლექსურ პარამეტრებს.

**`Kconfig` პარამეტრები:**

`Component config` -> `Synapse Framework` -> `Modules` -> `Timer Test Module` მენიუში შეგიძლიათ, ჩართოთ ან გამორთოთ ეს მოდული (`Enable Timer Test Module`).

**`system_config.json` მაგალითი:**

```json
{
    "type": "timer_test",
    "enabled": true,
    "config": {
        "instance_name": "main_timer_test"
    }
}
```

## 4. 🚀 მუშაობის ლოგიკა

1. **`start` ფაზა:**
    - მოდული იღებს `System Timer` და `RGB LED Indicator` სერვისების handle-ებს `Service Locator`-იდან.
    - ის იყენებს ტაიმერის სერვისს და გეგმავს პერიოდულ ივენთს, `EVT_TOGGLE_LED_COLOR`, რომელიც ყოველ 3 წამში ერთხელ გამოქვეყნდება.

2. **`handle_event` ფაზა:**
    - როდესაც `Event Bus`-ზე გამოქვეყნდება `EVT_TOGGLE_LED_COLOR` ივენთი, მოდულის `handle_event` ფუნქცია იღებს მას.
    - ფუნქცია ამოწმებს LED-ის მიმდინარე მდგომარეობას:
        - თუ LED **ჩართულია**, ის იძახებს `led_api->turn_off()`-ს.
        - თუ LED **გამორთულია**, ის აგენერირებს შემთხვევით RGB ფერს და იძახებს `led_api->set_color()`-ს.

3. **`deinit` ფაზა:**
    - მოდულის დეინიციალიზაციისას, ის აუქმებს თავის მიერ შექმნილ ტაიმერს (`cancel_event`) და ათავისუფლებს LED-ის კონტროლს (`release_control`), რათა LED-ი დაუბრუნდეს თავის ნორმალურ, სისტემურ რეჟიმს.

## 5. ❗ მნიშვნელოვანი შენიშვნები

- **დამოკიდებულებები `CMakeLists.txt`-ში:** ამ მოდულის `CMakeLists.txt` ფაილი `REQUIRES` სექციაში შეიცავს `system_timer`-ს და `rgb_led_indicator`-ს, რათა build-სისტემამ შეძლოს შესაბამისი ინტერფეისების პოვნა.
- **გამორთვა:** ტესტირების დასრულების შემდეგ, რეკომენდებულია ამ მოდულის გამორთვა `menuconfig`-იდან, რათა ის არ მოხვდეს საბოლოო, production firmware-ში.
