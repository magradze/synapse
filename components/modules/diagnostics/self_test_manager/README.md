# ğŸ©º áƒ›áƒáƒ“áƒ£áƒšáƒ˜: `self_test_manager`

**ğŸ—‚ï¸ áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ:** `diagnostics`  
**âœ’ï¸ áƒáƒ•áƒ¢áƒáƒ áƒ˜:** Synapse Framework Team  
**ğŸ”– áƒ•áƒ”áƒ áƒ¡áƒ˜áƒ:** 1.2.0

## 1. ğŸ“œ áƒ›áƒ˜áƒ›áƒáƒ®áƒ˜áƒšáƒ•áƒ

`self_test_manager` áƒáƒ áƒ˜áƒ¡ Synapse Framework-áƒ˜áƒ¡ **áƒªáƒ”áƒœáƒ¢áƒ áƒáƒšáƒ˜áƒ–áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ—áƒ•áƒ˜áƒ—-áƒ“áƒ˜áƒáƒ’áƒœáƒáƒ¡áƒ¢áƒ˜áƒ™áƒ˜áƒ¡ áƒ›áƒáƒ“áƒ£áƒšáƒ˜**. áƒ›áƒ˜áƒ¡áƒ˜ áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜ áƒáƒ›áƒáƒªáƒáƒœáƒáƒ, áƒ£áƒ–áƒ áƒ£áƒœáƒ•áƒ”áƒšáƒ§áƒáƒ¡ áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ˜áƒ¡ áƒ™áƒáƒ›áƒáƒáƒœáƒ”áƒœáƒ¢áƒ”áƒ‘áƒ˜áƒ¡, áƒ¡áƒ”áƒ áƒ•áƒ˜áƒ¡áƒ”áƒ‘áƒ˜áƒ¡ áƒ“áƒ áƒáƒ”áƒ áƒ˜áƒ¤áƒ”áƒ áƒ˜áƒ˜áƒ¡ áƒ¯áƒáƒœáƒ›áƒ áƒ—áƒ”áƒšáƒáƒ‘áƒ˜áƒ¡ áƒ¨áƒ”áƒ›áƒáƒ¬áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒ”áƒ áƒ—áƒ˜áƒáƒœáƒ˜, áƒ›áƒáƒ—áƒ®áƒáƒ•áƒœáƒáƒ–áƒ”-áƒ“áƒáƒ¤áƒ£áƒ«áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ›áƒ”áƒ¥áƒáƒœáƒ˜áƒ–áƒ›áƒ˜.

áƒ”áƒ¡ áƒ›áƒáƒ“áƒ£áƒšáƒ˜ áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ”áƒ‘áƒáƒ¡ áƒ’áƒ•áƒáƒ«áƒšáƒ”áƒ•áƒ¡, áƒœáƒ”áƒ‘áƒ˜áƒ¡áƒ›áƒ˜áƒ”áƒ  áƒ“áƒ áƒáƒ¡ (áƒ›áƒáƒ’., áƒ©áƒáƒ áƒ—áƒ•áƒ˜áƒ¡áƒáƒ¡, áƒ“áƒ˜áƒ¡áƒ¢áƒáƒœáƒªáƒ˜áƒ£áƒ áƒ˜ áƒ‘áƒ áƒ«áƒáƒœáƒ”áƒ‘áƒ˜áƒ— áƒáƒœ áƒ¬áƒáƒ áƒ›áƒáƒ”áƒ‘áƒ˜áƒ¡ áƒ®áƒáƒ–áƒ–áƒ”) áƒ’áƒáƒ•áƒ£áƒ¨áƒ•áƒáƒ— áƒ¢áƒ”áƒ¡áƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ¡áƒ áƒ£áƒšáƒ˜ áƒáƒœ áƒœáƒáƒ¬áƒ˜áƒšáƒáƒ‘áƒ áƒ˜áƒ•áƒ˜ áƒœáƒáƒ™áƒ áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ›áƒ˜áƒ•áƒ˜áƒ¦áƒáƒ— áƒ“áƒ”áƒ¢áƒáƒšáƒ£áƒ áƒ˜, áƒ¡áƒ¢áƒ áƒ£áƒ¥áƒ¢áƒ£áƒ áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ áƒ”áƒáƒáƒ áƒ¢áƒ˜ áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ˜áƒ¡ áƒ›áƒ“áƒ’áƒáƒ›áƒáƒ áƒ”áƒáƒ‘áƒ˜áƒ¡ áƒ¨áƒ”áƒ¡áƒáƒ®áƒ”áƒ‘. áƒ˜áƒ¡ áƒ™áƒ áƒ˜áƒ¢áƒ˜áƒ™áƒ£áƒšáƒáƒ“ áƒ›áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒšáƒáƒ•áƒáƒœáƒ˜áƒ áƒ áƒáƒ’áƒáƒ áƒª áƒ’áƒáƒ›áƒáƒ áƒ—áƒ•áƒ˜áƒ¡ (debugging) áƒáƒ áƒáƒªáƒ”áƒ¡áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡, áƒ˜áƒ¡áƒ” áƒ›áƒáƒ¬áƒ§áƒáƒ‘áƒ˜áƒšáƒáƒ‘áƒ˜áƒ¡ áƒ’áƒ áƒ«áƒ”áƒšáƒ•áƒáƒ“áƒ˜áƒáƒœáƒ˜ áƒ¡áƒáƒ˜áƒ›áƒ”áƒ“áƒáƒáƒ‘áƒ˜áƒ¡ áƒ£áƒ–áƒ áƒ£áƒœáƒ•áƒ”áƒšáƒ¡áƒáƒ§áƒáƒ¤áƒáƒ“.

## 2. ğŸ›ï¸ áƒáƒ áƒ¥áƒ˜áƒ¢áƒ”áƒ¥áƒ¢áƒ£áƒ áƒ£áƒšáƒ˜ áƒáƒ áƒ˜áƒœáƒªáƒ˜áƒáƒ”áƒ‘áƒ˜

- **âš™ï¸ Service Consumer:** áƒ›áƒáƒ“áƒ£áƒšáƒ˜ áƒáƒ áƒ˜áƒ¡ áƒ¡áƒ£áƒ¤áƒ—áƒ "áƒ¡áƒ”áƒ áƒ•áƒ˜áƒ¡áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ˜". áƒ˜áƒ¡ áƒáƒ  áƒáƒ¬áƒ•áƒ“áƒ˜áƒ¡ áƒ¡áƒáƒ™áƒ£áƒ—áƒáƒ  Service API-áƒ¡, áƒáƒ áƒáƒ›áƒ”áƒ“ áƒáƒ¥áƒ¢áƒ˜áƒ£áƒ áƒáƒ“ áƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ¡ áƒ¤áƒ áƒ”áƒ˜áƒ›áƒ•áƒáƒ áƒ¥áƒ˜áƒ¡ áƒ¡áƒ®áƒ•áƒ áƒ¡áƒ”áƒ áƒ•áƒ˜áƒ¡áƒ”áƒ‘áƒ¡ (`System Manager`, `Health Monitor`, `Storage Manager` áƒ“áƒ áƒ.áƒ¨.) áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ˜áƒ¡ áƒ™áƒáƒ›áƒáƒáƒœáƒ”áƒœáƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ¨áƒ”áƒ¡áƒáƒ›áƒáƒ¬áƒ›áƒ”áƒ‘áƒšáƒáƒ“.
- **âŒ¨ï¸ CLI-áƒ–áƒ” áƒ“áƒáƒ¤áƒ£áƒ«áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ›áƒáƒ áƒ—áƒ•áƒ:** áƒ›áƒáƒ“áƒ£áƒšáƒ˜áƒ¡ áƒ¡áƒ áƒ£áƒšáƒ˜ áƒ›áƒáƒ áƒ—áƒ•áƒ áƒ®áƒ“áƒ”áƒ‘áƒ `Command Router`-áƒ˜áƒ¡ áƒ›áƒ”áƒ¨áƒ•áƒ”áƒáƒ‘áƒ˜áƒ— áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜ `selftest` áƒ‘áƒ áƒ«áƒáƒœáƒ”áƒ‘áƒ˜áƒ—. áƒ”áƒ¡ áƒ£áƒ–áƒ áƒ£áƒœáƒ•áƒ”áƒšáƒ§áƒáƒ¤áƒ¡ áƒ›áƒ˜áƒ¡ áƒ®áƒ”áƒšáƒ›áƒ˜áƒ¡áƒáƒ¬áƒ•áƒ“áƒáƒ›áƒáƒ‘áƒáƒ¡ áƒœáƒ”áƒ‘áƒ˜áƒ¡áƒ›áƒ˜áƒ”áƒ áƒ˜ áƒ˜áƒœáƒ¢áƒ”áƒ áƒ¤áƒ”áƒ˜áƒ¡áƒ˜áƒ“áƒáƒœ (Serial, MQTT, HTTP).
- **ğŸ“¨ áƒ˜áƒ•áƒ”áƒœáƒ—áƒ–áƒ”-áƒ“áƒáƒ¤áƒ£áƒ«áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒáƒáƒ¡áƒ£áƒ®áƒ˜:** áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ¡ áƒ áƒ”áƒáƒáƒ áƒ¢áƒ˜áƒ¡ áƒ›áƒáƒ—áƒ®áƒáƒ•áƒœáƒ˜áƒ¡áƒáƒ¡, áƒ›áƒáƒ“áƒ£áƒšáƒ˜, áƒ™áƒáƒœáƒ¡áƒáƒšáƒ¨áƒ˜ áƒ‘áƒ”áƒ­áƒ“áƒ•áƒ˜áƒ¡ áƒáƒáƒ áƒáƒšáƒ”áƒšáƒ£áƒ áƒáƒ“, `Event Bus`-áƒ–áƒ” áƒáƒ¥áƒ•áƒ”áƒ§áƒœáƒ”áƒ‘áƒ¡ `SYNAPSE_EVENT_SELF_TEST_REPORT_READY` áƒ˜áƒ•áƒ”áƒœáƒ—áƒ¡, áƒ áƒáƒ›áƒšáƒ˜áƒ¡ `payload` áƒáƒ áƒ˜áƒ¡ áƒ áƒ”áƒáƒáƒ áƒ¢áƒ˜ JSON áƒ¤áƒáƒ áƒ›áƒáƒ¢áƒ¨áƒ˜. áƒ”áƒ¡ áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ”áƒ‘áƒáƒ¡ áƒáƒ«áƒšáƒ”áƒ•áƒ¡ `mqtt_manager`-áƒ¡ áƒ“áƒ áƒ¡áƒ®áƒ•áƒ áƒ›áƒáƒ“áƒ£áƒšáƒ”áƒ‘áƒ¡, áƒ›áƒ˜áƒ˜áƒ¦áƒáƒœ áƒ“áƒ áƒ’áƒáƒáƒ•áƒ áƒªáƒ”áƒšáƒáƒœ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ¡ áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ”áƒ‘áƒ˜.
- **ğŸš€ áƒáƒ áƒáƒ‘áƒšáƒáƒ™áƒ˜áƒ áƒ”áƒ‘áƒáƒ“áƒ˜ áƒ¨áƒ”áƒ¡áƒ áƒ£áƒšáƒ”áƒ‘áƒ:** áƒ¢áƒ”áƒ¡áƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ¡áƒ áƒ£áƒšáƒ˜ áƒœáƒáƒ™áƒ áƒ”áƒ‘áƒ˜ áƒ”áƒ¨áƒ•áƒ”áƒ‘áƒ áƒ’áƒáƒ›áƒáƒ§áƒáƒ¤áƒ˜áƒš, áƒ“áƒ áƒáƒ”áƒ‘áƒ˜áƒ— FreeRTOS áƒ¢áƒáƒ¡áƒ™áƒ¨áƒ˜. áƒ”áƒ¡ áƒ£áƒ–áƒ áƒ£áƒœáƒ•áƒ”áƒšáƒ§áƒáƒ¤áƒ¡, áƒ áƒáƒ› áƒ“áƒ˜áƒáƒ’áƒœáƒáƒ¡áƒ¢áƒ˜áƒ™áƒ˜áƒ¡ áƒáƒ áƒáƒªáƒ”áƒ¡áƒ˜ áƒáƒ  áƒ‘áƒšáƒáƒ™áƒáƒ•áƒ¡ áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ˜áƒ¡ áƒ«áƒ˜áƒ áƒ˜áƒ—áƒáƒ“ áƒœáƒáƒ™áƒáƒ“áƒ¡ áƒáƒœ `Command Router`-áƒ˜áƒ¡ áƒ˜áƒœáƒ¢áƒ”áƒ áƒáƒ¥áƒ¢áƒ˜áƒ£áƒš áƒ’áƒáƒ áƒ¡áƒ¡.
- **ğŸ” áƒ›áƒáƒ¦áƒáƒšáƒ˜ áƒ˜áƒœáƒ˜áƒªáƒ˜áƒáƒšáƒ˜áƒ–áƒáƒªáƒ˜áƒ˜áƒ¡ áƒ“áƒáƒœáƒ” (`init_level: 80`):** áƒ áƒáƒ’áƒáƒ áƒª áƒ—áƒ˜áƒ—áƒ¥áƒ›áƒ˜áƒ¡ áƒ§áƒ•áƒ”áƒšáƒ áƒ¡áƒ®áƒ•áƒ áƒ¡áƒ”áƒ áƒ•áƒ˜áƒ¡áƒ˜áƒ¡ áƒ›áƒáƒ›áƒ®áƒ›áƒáƒ áƒ”áƒ‘áƒ”áƒšáƒ˜, áƒ˜áƒ¡ áƒ˜áƒœáƒ˜áƒªáƒ˜áƒáƒšáƒ˜áƒ–áƒ“áƒ”áƒ‘áƒ áƒ”áƒ áƒ—-áƒ”áƒ áƒ—áƒ˜ áƒ‘áƒáƒšáƒ, áƒ áƒáƒ—áƒ áƒ“áƒáƒ áƒ¬áƒ›áƒ£áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ˜áƒ§áƒáƒ¡, áƒ áƒáƒ› áƒ§áƒ•áƒ”áƒšáƒ áƒ¨áƒ”áƒ¡áƒáƒ›áƒáƒ¬áƒ›áƒ”áƒ‘áƒ”áƒšáƒ˜ áƒ™áƒáƒ›áƒáƒáƒœáƒ”áƒœáƒ¢áƒ˜ áƒ£áƒ™áƒ•áƒ” áƒ®áƒ”áƒšáƒ›áƒ˜áƒ¡áƒáƒ¬áƒ•áƒ“áƒáƒ›áƒ˜áƒ.

## 3. âš™ï¸ áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ

áƒ›áƒáƒ“áƒ£áƒšáƒ˜áƒ¡ áƒ«áƒ˜áƒ áƒ˜áƒ—áƒáƒ“áƒ˜ áƒáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ˜ áƒ˜áƒ›áƒáƒ áƒ—áƒ”áƒ‘áƒ `Kconfig`-áƒ˜áƒ¡ (`idf.py menuconfig`) áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ”áƒ‘áƒ˜áƒ—.

**`system_config.json` áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜:**

```json
{
    "type": "self_test_manager",
    "enabled": true,
    "config": {
        "instance_name": "selftest"
    }
}
```

**áƒ¨áƒ”áƒœáƒ˜áƒ¨áƒ•áƒœáƒ:** `instance_name` áƒ£áƒœáƒ“áƒ áƒ˜áƒ§áƒáƒ¡ áƒ¡áƒáƒ™áƒ›áƒáƒ áƒ˜áƒ¡áƒáƒ“ áƒ›áƒáƒ™áƒšáƒ”, áƒ áƒáƒ—áƒ `storage_manager`-áƒ˜áƒ¡ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ˜áƒ¡áƒáƒ¡ áƒáƒ  áƒ’áƒáƒ“áƒáƒáƒ­áƒáƒ áƒ‘áƒáƒ¡ SPIFFS-áƒ˜áƒ¡ áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜áƒ¡ áƒ¡áƒ˜áƒ’áƒ áƒ«áƒ˜áƒ¡ áƒšáƒ˜áƒ›áƒ˜áƒ¢áƒ¡.

**`Kconfig` áƒáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ˜:**

`Component config` -> `Synapse Framework` -> `Modules` -> `Self Test Manager` áƒ›áƒ”áƒœáƒ˜áƒ£áƒ¨áƒ˜ áƒ¨áƒ”áƒ’áƒ˜áƒ«áƒšáƒ˜áƒáƒ— áƒ“áƒáƒáƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒ˜áƒ áƒáƒ—:

- **`Self-Test Task Stack Size`:** áƒ“áƒ áƒáƒ”áƒ‘áƒ˜áƒ—áƒ˜ áƒ¢áƒáƒ¡áƒ™áƒ˜áƒ¡ áƒ¡áƒ¢áƒ”áƒ™áƒ˜áƒ¡ áƒ–áƒáƒ›áƒ.
- **`Maximum Lines in Test Report`:** áƒ áƒ”áƒáƒáƒ áƒ¢áƒ¨áƒ˜ áƒ®áƒáƒ–áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ¥áƒ¡áƒ˜áƒ›áƒáƒšáƒ£áƒ áƒ˜ áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ.

## 4. âŒ¨ï¸ CLI áƒ‘áƒ áƒ«áƒáƒœáƒ”áƒ‘áƒ”áƒ‘áƒ˜ (Command Line Interface)

áƒ›áƒáƒ“áƒ£áƒšáƒ˜ áƒáƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒ˜áƒ áƒ”áƒ‘áƒ¡ `selftest` áƒ‘áƒ áƒ«áƒáƒœáƒ”áƒ‘áƒáƒ¡ `Command Router`-áƒ¨áƒ˜.

| áƒ‘áƒ áƒ«áƒáƒœáƒ”áƒ‘áƒ | áƒáƒ áƒ’áƒ£áƒ›áƒ”áƒœáƒ¢áƒ”áƒ‘áƒ˜ | áƒáƒ¦áƒ¬áƒ”áƒ áƒ |
| :--- | :--- | :--- |
| `selftest --run` | `[all\|core\|health\|storage\|conn]` | ğŸš€ áƒ˜áƒ¬áƒ§áƒ”áƒ‘áƒ¡ áƒ¢áƒ”áƒ¡áƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ¨áƒ”áƒ¡áƒ áƒ£áƒšáƒ”áƒ‘áƒáƒ¡. áƒáƒ áƒ’áƒ£áƒ›áƒ”áƒœáƒ¢áƒ˜áƒ¡ áƒ’áƒáƒ áƒ”áƒ¨áƒ” (`all`) áƒ’áƒáƒ”áƒ¨áƒ•áƒ”áƒ‘áƒ áƒ§áƒ•áƒ”áƒšáƒ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜. |
| `selftest --report` | - | ğŸ“Š áƒ’áƒáƒ›áƒáƒáƒ¥áƒ•áƒ¡ áƒ‘áƒáƒšáƒ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ¡ áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ”áƒ‘áƒ˜áƒ¡ áƒ áƒ”áƒáƒáƒ áƒ¢áƒ˜ áƒ™áƒáƒœáƒ¡áƒáƒšáƒ¨áƒ˜ **áƒ“áƒ** áƒáƒ¥áƒ•áƒ”áƒ§áƒœáƒ”áƒ‘áƒ¡ JSON áƒ áƒ”áƒáƒáƒ áƒ¢áƒ¡ `Event Bus`-áƒ–áƒ”. |

**áƒ’áƒáƒ›áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜:**

```bash
# áƒ§áƒ•áƒ”áƒšáƒ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ¡ áƒ’áƒáƒ¨áƒ•áƒ”áƒ‘áƒ
SYNAPSE> selftest --run all

# áƒ›áƒ®áƒáƒšáƒáƒ“ storage áƒ¥áƒ•áƒ”áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ˜áƒ¡ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ
SYNAPSE> selftest --run storage

# áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ”áƒ‘áƒ˜áƒ¡ áƒœáƒáƒ®áƒ•áƒ
SYNAPSE> selftest --report
```

## 5. ğŸ“¡ MQTT áƒ˜áƒœáƒ¢áƒ”áƒ áƒ¤áƒ”áƒ˜áƒ¡áƒ˜

`selftest` áƒ‘áƒ áƒ«áƒáƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ’áƒáƒ›áƒáƒ«áƒáƒ®áƒ”áƒ‘áƒ áƒ¨áƒ”áƒ¡áƒáƒ«áƒšáƒ”áƒ‘áƒ”áƒšáƒ˜áƒ MQTT-áƒ˜áƒ—, `Command Router`-áƒ˜áƒ¡ áƒ›áƒ”áƒ¨áƒ•áƒ”áƒáƒ‘áƒ˜áƒ—.

- **áƒ‘áƒ áƒ«áƒáƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ’áƒáƒ’áƒ–áƒáƒ•áƒœáƒ:**
  - **Topic:** `synapse/devices/{id}/cmd/in`
  - **Payload:** `"selftest --report"`
- **áƒáƒáƒ¡áƒ£áƒ®áƒ˜áƒ¡ áƒ›áƒ˜áƒ¦áƒ”áƒ‘áƒ (JSON):**
  - **Topic:** `synapse/devices/{id}/data/selftest/report`
  - **Payload (áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜):**

    ```json
    {"last_run_ms_ago":8547,"results":[{"test":"Core Services Check","status":"PASS","details":""},{"test":"Free Heap","status":"PASS","details":"71032 bytes"},{"test":"Storage Check","status":"PASS","details":"Write/Read/Erase OK"},{"test":"main_wifi_manager","status":"PASS","details":"Running"},{"test":"main_mqtt_broker","status":"PASS","details":"Running"}]}
    ```

## 6. ğŸ’¡ áƒáƒ®áƒáƒšáƒ˜ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ¡ áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜

áƒ¬áƒáƒ áƒ›áƒáƒ•áƒ˜áƒ“áƒ’áƒ˜áƒœáƒáƒ—, áƒ’áƒ•áƒ˜áƒœáƒ“áƒ áƒ“áƒáƒ•áƒáƒ›áƒáƒ¢áƒáƒ— áƒ¢áƒ”áƒ¡áƒ¢áƒ˜, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒáƒ›áƒáƒ¬áƒ›áƒ”áƒ‘áƒ¡ `rgb_led_indicator`-áƒ˜áƒ¡ áƒ›áƒ£áƒ¨áƒáƒáƒ‘áƒáƒ¡.

**áƒœáƒáƒ‘áƒ˜áƒ¯áƒ˜ 1: áƒ¨áƒ”áƒ¥áƒ›áƒ”áƒœáƒ˜áƒ— áƒáƒ®áƒáƒšáƒ˜ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ¡ áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ `self_test_manager.c`-áƒ¨áƒ˜**

```c
/**
 * @internal
 * @brief Test suite for the RGB LED Indicator.
 * @details Checks if the service is available and briefly cycles through colors.
 */
static void run_rgb_led_check(self_test_private_data_t *private_data) {
    // 1. Find the service by its type
    service_handle_t led_handle = synapse_service_lookup_by_type(SYNAPSE_SERVICE_TYPE_RGB_LED_API);
    if (!led_handle) {
        add_report_line(private_data, "RGB LED Check", TEST_RESULT_SKIPPED, "RGB LED service not found");
        return;
    }
    rgb_led_api_t *led_api = (rgb_led_api_t *)led_handle;

    // 2. Perform a simple test: cycle through Red, Green, Blue
    led_api->set_color(255, 0, 0); // Red
    vTaskDelay(pdMS_TO_TICKS(200));
    led_api->set_color(0, 255, 0); // Green
    vTaskDelay(pdMS_TO_TICKS(200));
    led_api->set_color(0, 0, 255); // Blue
    vTaskDelay(pdMS_TO_TICKS(200));
    
    // 3. Release control to return to automatic state
    led_api->release_control();

    // 4. Add result to the report
    add_report_line(private_data, "RGB LED Check", TEST_RESULT_PASS, "Color cycle OK");
}
```

**áƒœáƒáƒ‘áƒ˜áƒ¯áƒ˜ 2: áƒ“áƒáƒáƒ›áƒáƒ¢áƒ”áƒ— áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ˜áƒ¡ `Forward Declaration`**

```c
// In the Forward Declarations section
static void run_rgb_led_check(self_test_private_data_t *private_data);
```

**áƒœáƒáƒ‘áƒ˜áƒ¯áƒ˜ 3: áƒ’áƒáƒ›áƒáƒ˜áƒ«áƒáƒ®áƒ”áƒ— áƒáƒ®áƒáƒšáƒ˜ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜ `run_tests_task`-áƒ¨áƒ˜**

```c
// Inside run_tests_task function
// ...
if (run_all || strcmp(suite_to_run, "conn") == 0) {
    printf("Running Connectivity Check...\n");
    run_connectivity_check(private_data);
    vTaskDelay(pdMS_TO_TICKS(50));
}
// â˜…â˜…â˜… Add the new test call here â˜…â˜…â˜…
if (run_all || strcmp(suite_to_run, "led") == 0) {
    printf("Running RGB LED Check...\n");
    run_rgb_led_check(private_data);
    vTaskDelay(pdMS_TO_TICKS(50));
}
// ...
```

**áƒœáƒáƒ‘áƒ˜áƒ¯áƒ˜ 4: áƒ’áƒáƒœáƒáƒáƒ®áƒšáƒ”áƒ— `usage` áƒ¡áƒ¢áƒ áƒ˜áƒ¥áƒáƒœáƒ˜ `cmd_t`-áƒ¨áƒ˜**

```c
// Inside self_test_manager_handle_event
static cmd_t selftest_cmd = {
    .command = "selftest",
    .help = "Run system self-diagnostics.",
    .usage = "selftest [--run [all|core|health|storage|conn|led]] [--report]", // <-- Add 'led'
    // ...
};
```

áƒáƒ› áƒªáƒ•áƒšáƒ˜áƒšáƒ”áƒ‘áƒ”áƒ‘áƒ˜áƒ¡ áƒ¨áƒ”áƒ›áƒ“áƒ”áƒ’, `selftest --run led` áƒ‘áƒ áƒ«áƒáƒœáƒ”áƒ‘áƒ áƒ’áƒáƒ£áƒ¨áƒ•áƒ”áƒ‘áƒ¡ áƒ›áƒ®áƒáƒšáƒáƒ“ LED-áƒ˜áƒ¡ áƒ¢áƒ”áƒ¡áƒ¢áƒ¡, áƒ®áƒáƒšáƒ `selftest --run all` áƒ›áƒáƒ¡áƒáƒª áƒ©áƒáƒ áƒ—áƒáƒ•áƒ¡ áƒ¡áƒáƒ”áƒ áƒ—áƒ áƒ¡áƒ˜áƒáƒ¨áƒ˜.

## 7. â— áƒ›áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒšáƒáƒ•áƒáƒœáƒ˜ áƒ¨áƒ”áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒ‘áƒ˜

- **áƒ“áƒáƒ›áƒáƒ™áƒ˜áƒ“áƒ”áƒ‘áƒ£áƒšáƒ”áƒ‘áƒ”áƒ‘áƒ˜:** `CMakeLists.txt`-áƒ¨áƒ˜, `REQUIRES` áƒ¡áƒ”áƒ¥áƒªáƒ˜áƒáƒ¨áƒ˜ áƒ£áƒœáƒ“áƒ áƒ˜áƒ§áƒáƒ¡ áƒ›áƒ˜áƒ—áƒ˜áƒ—áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ§áƒ•áƒ”áƒšáƒ áƒ˜áƒ¡ áƒ›áƒáƒ“áƒ£áƒšáƒ˜, áƒ áƒáƒ›áƒšáƒ˜áƒ¡ Service API-áƒ¡áƒáƒª áƒ”áƒ¡ áƒ›áƒáƒ“áƒ£áƒšáƒ˜ áƒáƒ˜áƒ áƒ“áƒáƒáƒ˜áƒ  áƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ¡ (áƒ›áƒáƒ’., `command_router`, `health_monitor`).
- **áƒáƒ áƒáƒ‘áƒšáƒáƒ™áƒ˜áƒ áƒ”áƒ‘áƒáƒ“áƒáƒ‘áƒ:** áƒ“áƒáƒ áƒ¬áƒ›áƒ£áƒœáƒ“áƒ˜áƒ—, áƒ áƒáƒ› áƒ—áƒ¥áƒ•áƒ”áƒœáƒ¡ áƒ›áƒ˜áƒ”áƒ  áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ¢áƒ”áƒ¡áƒ¢áƒ”áƒ‘áƒ˜ áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒ®áƒáƒœáƒ’áƒ áƒ«áƒšáƒ˜áƒ•áƒ˜ áƒáƒœ áƒ›áƒ‘áƒšáƒáƒ™áƒáƒ•áƒ˜. áƒ—áƒ£ áƒ¢áƒ”áƒ¡áƒ¢áƒ¡ áƒ“áƒ˜áƒ“áƒ˜ áƒ“áƒ áƒ áƒ¡áƒ­áƒ˜áƒ áƒ“áƒ”áƒ‘áƒ, áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒ”áƒ— `vTaskDelay`, áƒ áƒáƒ—áƒ áƒ¡áƒ®áƒ•áƒ áƒ¢áƒáƒ¡áƒ™áƒ”áƒ‘áƒ¡áƒáƒª áƒ›áƒ˜áƒ”áƒªáƒ”áƒ— áƒ›áƒ£áƒ¨áƒáƒáƒ‘áƒ˜áƒ¡ áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ”áƒ‘áƒ.
