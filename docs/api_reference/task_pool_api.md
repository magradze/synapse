# Synapse Task Pool Manager API Reference

## ­Ъј» рЃЏрЃўрЃќрЃљрЃюрЃў

рЃћрЃА рЃЊрЃЮрЃЎрЃБрЃЏрЃћрЃюрЃбрЃў рЃљрЃдрЃгрЃћрЃарЃА `Task Pool Manager`-рЃўрЃА рЃАрЃљрЃ»рЃљрЃарЃЮ API-рЃА, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃ«рЃћрЃџрЃЏрЃўрЃАрЃљрЃгрЃЋрЃЊрЃЮрЃЏрЃўрЃљ `synapse.h` рЃ░рЃћрЃЊрЃћрЃарЃўрЃА рЃЏрЃћрЃерЃЋрЃћрЃЮрЃЉрЃўрЃЌ. рЃћрЃА API рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃљрЃА рЃљрЃФрЃџрЃћрЃЋрЃА рЃЏрЃЮрЃЊрЃБрЃџрЃћрЃЉрЃА, рЃерЃћрЃљрЃАрЃарЃБрЃџрЃЮрЃю рЃцрЃЮрЃюрЃБрЃарЃў, рЃћрЃарЃЌрЃ»рЃћрЃарЃљрЃЊрЃў рЃљрЃю рЃърЃћрЃарЃўрЃЮрЃЊрЃБрЃџрЃў рЃАрЃљрЃЏрЃБрЃерЃљрЃЮрЃћрЃЉрЃў `core`-рЃўрЃА рЃЏрЃўрЃћрЃа рЃЏрЃљрЃарЃЌрЃЋрЃљрЃЊ, рЃњрЃљрЃќрЃўрЃљрЃарЃћрЃЉрЃБрЃџ рЃбрЃљрЃАрЃЎрЃћрЃЉрЃерЃў, рЃАрЃљрЃЎрЃБрЃЌрЃљрЃарЃў FreeRTOS рЃбрЃљрЃАрЃЎрЃўрЃА рЃерЃћрЃЦрЃЏрЃюрЃўрЃА рЃњрЃљрЃарЃћрЃерЃћ.

рЃћрЃА рЃърЃљрЃбрЃћрЃарЃюрЃў рЃарЃћрЃЎрЃЮрЃЏрЃћрЃюрЃЊрЃћрЃЉрЃБрЃџрЃўрЃљ рЃарЃћрЃАрЃБрЃарЃАрЃћрЃЉрЃўрЃА (рЃњрЃљрЃюрЃАрЃљрЃЎрЃБрЃЌрЃарЃћрЃЉрЃўрЃЌ RAM-рЃўрЃА) рЃЮрЃърЃбрЃўрЃЏрЃўрЃќрЃљрЃфрЃўрЃўрЃАрЃЌрЃЋрЃўрЃА.

---

## API-рЃА рЃбрЃўрЃърЃћрЃЉрЃў рЃЊрЃљ рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃћрЃЉрЃў

### `synapse_job_handle_t`

рЃћрЃА рЃљрЃарЃўрЃА "рЃњрЃљрЃБрЃЏрЃГрЃЋрЃўрЃарЃЋрЃљрЃџрЃћ" (opaque) `handle`-рЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃгрЃљрЃарЃЏрЃЮрЃљрЃЊрЃњрЃћрЃюрЃА рЃЊрЃљрЃњрЃћрЃњрЃЏрЃўрЃџ рЃАрЃљрЃЏрЃБрЃерЃљрЃЮрЃА (`Job`). рЃЌрЃЦрЃЋрЃћрЃю рЃўрЃдрЃћрЃЉрЃЌ рЃЏрЃљрЃА `synapse_task_pool_schedule_job` рЃцрЃБрЃюрЃЦрЃфрЃўрЃўрЃА рЃњрЃљрЃЏрЃЮрЃФрЃљрЃ«рЃћрЃЉрЃўрЃАрЃљрЃА рЃЊрЃљ рЃўрЃДрЃћрЃюрЃћрЃЉрЃЌ `synapse_task_pool_cancel_job` рЃцрЃБрЃюрЃЦрЃфрЃўрЃљрЃерЃў рЃАрЃљрЃЏрЃБрЃерЃљрЃЮрЃА рЃњрЃљрЃАрЃљрЃБрЃЦрЃЏрЃћрЃЉрЃџрЃљрЃЊ.

```c
typedef struct synapse_job_t* synapse_job_handle_t;
```

### `synapse_job_cb`

рЃћрЃА рЃљрЃарЃўрЃА `callback` рЃцрЃБрЃюрЃЦрЃфрЃўрЃўрЃА рЃбрЃўрЃърЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃБрЃюрЃЊрЃљ рЃерЃћрЃЦрЃЏрЃюрЃљрЃЌ рЃЌрЃЦрЃЋрЃћрЃюрЃА рЃЏрЃЮрЃЊрЃБрЃџрЃерЃў. `Task Pool Manager`-рЃўрЃА "рЃЏрЃБрЃерЃљ" рЃбрЃљрЃАрЃЎрЃў рЃњрЃљрЃЏрЃЮрЃўрЃФрЃљрЃ«рЃћрЃЉрЃА рЃљрЃЏ рЃцрЃБрЃюрЃЦрЃфрЃўрЃљрЃА, рЃарЃЮрЃЊрЃћрЃАрЃљрЃф рЃАрЃљрЃЏрЃБрЃерЃљрЃЮрЃА рЃерЃћрЃАрЃарЃБрЃџрЃћрЃЉрЃўрЃА рЃЊрЃарЃЮ рЃЏрЃЮрЃЋрЃљ.

```c
typedef void (*synapse_job_cb)(void* user_context);
```

- **`user_context`**: рЃЏрЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃћрЃџрЃў рЃЏрЃЮрЃЏрЃ«рЃЏрЃљрЃарЃћрЃЉрЃџрЃўрЃА рЃЏрЃўрЃћрЃа рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃБрЃџ рЃЎрЃЮрЃюрЃбрЃћрЃЦрЃАрЃбрЃќрЃћ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф `schedule_job` рЃцрЃБрЃюрЃЦрЃфрЃўрЃўрЃА рЃњрЃљрЃЏрЃЮрЃФрЃљрЃ«рЃћрЃЉрЃўрЃАрЃљрЃА рЃњрЃљрЃЊрЃљрЃћрЃфрЃљ. рЃарЃЮрЃњрЃЮрЃарЃф рЃгрЃћрЃАрЃў, рЃћрЃА рЃљрЃарЃўрЃА рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА `module_t*` рЃљрЃю `private_data` рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃўрЃА рЃЏрЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃћрЃџрЃў.

**@warning:** рЃљрЃЏ рЃцрЃБрЃюрЃЦрЃфрЃўрЃўрЃА рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ рЃБрЃюрЃЊрЃљ рЃўрЃДрЃЮрЃА **рЃљрЃарЃљрЃЉрЃџрЃЮрЃЎрЃўрЃарЃћрЃЉрЃљрЃЊрЃў** рЃЊрЃљ **рЃАрЃгрЃарЃљрЃцрЃљрЃЊ рЃерЃћрЃАрЃарЃБрЃџрЃћрЃЉрЃљрЃЊрЃў**. рЃ«рЃљрЃюрЃњрЃарЃФрЃџрЃўрЃЋрЃЏрЃљ рЃЮрЃърЃћрЃарЃљрЃфрЃўрЃћрЃЉрЃЏрЃљ (`vTaskDelay`-рЃА рЃЊрЃўрЃЊрЃў рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃўрЃЌ, рЃЦрЃАрЃћрЃџрЃБрЃарЃў рЃџрЃЮрЃЊрЃўрЃюрЃў) рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃЊрЃљрЃљрЃЉрЃџрЃЮрЃЎрЃЮрЃА "рЃЏрЃБрЃерЃљ" рЃбрЃљрЃАрЃЎрЃў рЃЊрЃљ рЃерЃћрЃљрЃцрЃћрЃарЃ«рЃЮрЃА рЃАрЃ«рЃЋрЃљ рЃЏрЃЮрЃЊрЃБрЃџрЃћрЃЉрЃўрЃА рЃАрЃљрЃЏрЃБрЃерЃљрЃЮрЃћрЃЉрЃўрЃА рЃерЃћрЃАрЃарЃБрЃџрЃћрЃЉрЃљ.

---

## API-рЃА рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў

### `synapse_job_handle_t synapse_task_pool_schedule_job(synapse_job_cb job_function, void* user_context, uint32_t interval_ms, bool is_periodic);`

рЃљрЃњрЃћрЃњрЃЏрЃљрЃарЃћрЃЉрЃА рЃљрЃ«рЃљрЃџ рЃАрЃљрЃЏрЃБрЃерЃљрЃЮрЃА (`Job`) `Task Pool`-рЃерЃў рЃерЃћрЃАрЃљрЃАрЃарЃБрЃџрЃћрЃЉрЃџрЃљрЃЊ.

- **`job_function`**: рЃЌрЃЦрЃЋрЃћрЃюрЃў `callback` рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃБрЃюрЃЊрЃљ рЃерЃћрЃАрЃарЃБрЃџрЃЊрЃћрЃА.
- **`user_context`**: (рЃљрЃарЃљрЃАрЃљрЃЋрЃљрЃџрЃЊрЃћрЃЉрЃБрЃџрЃЮ) рЃЏрЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃћрЃџрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃњрЃљрЃЊрЃљрЃћрЃфрЃћрЃЏрЃљ рЃЌрЃЦрЃЋрЃћрЃюрЃА `job_function`-рЃА.
- **`interval_ms`**: рЃърЃћрЃарЃўрЃЮрЃЊрЃБрЃџрЃў рЃАрЃљрЃЏрЃБрЃерЃљрЃЮрЃА рЃерЃћрЃАрЃарЃБрЃџрЃћрЃЉрЃўрЃА рЃўрЃюрЃбрЃћрЃарЃЋрЃљрЃџрЃў рЃЏрЃўрЃџрЃўрЃгрЃљрЃЏрЃћрЃЉрЃерЃў. рЃћрЃарЃЌрЃ»рЃћрЃарЃљрЃЊрЃў рЃАрЃљрЃЏрЃБрЃерЃљрЃЮрЃАрЃЌрЃЋрЃўрЃА рЃљрЃЏ рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ рЃљрЃа рЃљрЃЦрЃЋрЃА, рЃЏрЃљрЃњрЃарЃљрЃЏ рЃарЃћрЃЎрЃЮрЃЏрЃћрЃюрЃЊрЃћрЃЉрЃБрЃџрЃўрЃљ `0`-рЃўрЃА рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃљ.
- **`is_periodic`**:
  - `true`: рЃАрЃљрЃЏрЃБрЃерЃљрЃЮ рЃерЃћрЃАрЃарЃБрЃџрЃЊрЃћрЃЉрЃљ рЃњрЃљрЃюрЃЏрЃћрЃЮрЃарЃћрЃЉрЃўрЃЌ, `interval_ms` рЃърЃћрЃарЃўрЃЮрЃЊрЃўрЃЌ.
  - `false`: рЃАрЃљрЃЏрЃБрЃерЃљрЃЮ рЃерЃћрЃАрЃарЃБрЃџрЃЊрЃћрЃЉрЃљ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃћрЃарЃЌрЃ«рЃћрЃџ, рЃЊрЃљрЃДрЃЮрЃЋрЃюрЃћрЃЉрЃўрЃА рЃњрЃљрЃарЃћрЃерЃћ.
- **рЃљрЃЉрЃарЃБрЃюрЃћрЃЉрЃА:** `synapse_job_handle_t` рЃЮрЃЉрЃўрЃћрЃЦрЃбрЃА рЃгрЃљрЃарЃЏрЃљрЃбрЃћрЃЉрЃўрЃА рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў, рЃљрЃю `NULL` рЃерЃћрЃфрЃЊрЃЮрЃЏрЃўрЃАрЃљрЃА (рЃЏрЃљрЃњ., рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃЮрЃцрЃўрЃА рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ).

### `esp_err_t synapse_task_pool_cancel_job(synapse_job_handle_t handle);`

рЃљрЃБрЃЦрЃЏрЃћрЃЉрЃА рЃљрЃЊрЃарЃћ рЃЊрЃљрЃњрЃћрЃњрЃЏрЃўрЃџ рЃърЃћрЃарЃўрЃЮрЃЊрЃБрЃџ рЃљрЃю рЃћрЃарЃЌрЃ»рЃћрЃарЃљрЃЊ рЃАрЃљрЃЏрЃБрЃерЃљрЃЮрЃА. рЃћрЃА рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ рЃљрЃБрЃфрЃўрЃџрЃћрЃЉрЃџрЃљрЃЊ рЃБрЃюрЃЊрЃљ рЃњрЃљрЃЏрЃЮрЃўрЃФрЃљрЃ«рЃЮрЃЌ рЃЏрЃЮрЃЊрЃБрЃџрЃўрЃА `deinit` рЃцрЃљрЃќрЃљрЃерЃў.

- **`handle`**: рЃњрЃљрЃАрЃљрЃБрЃЦрЃЏрЃћрЃЉрЃћрЃџрЃў рЃАрЃљрЃЏрЃБрЃерЃљрЃЮрЃА `handle`-рЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃЏрЃўрЃўрЃдрЃћрЃЌ `schedule_job` рЃцрЃБрЃюрЃЦрЃфрЃўрЃўрЃЊрЃљрЃю.
- **рЃљрЃЉрЃарЃБрЃюрЃћрЃЉрЃА:**
  - `ESP_OK`: рЃЌрЃБ рЃАрЃљрЃЏрЃБрЃерЃљрЃЮ рЃгрЃљрЃарЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌ рЃЏрЃЮрЃўрЃФрЃћрЃЉрЃюрЃљ рЃЊрЃљ рЃњрЃљрЃБрЃЦрЃЏрЃЊрЃљ.
  - `ESP_ERR_INVALID_ARG`: рЃЌрЃБ рЃњрЃљрЃЊрЃљрЃфрЃћрЃЏрЃБрЃџрЃў `handle` рЃљрЃарЃўрЃА `NULL`.
  - `ESP_ERR_NOT_FOUND`: рЃЌрЃБ рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃБрЃџрЃў `handle`-рЃўрЃА рЃЏрЃЦрЃЮрЃюрЃћ рЃАрЃљрЃЏрЃБрЃерЃљрЃЮ рЃЋрЃћрЃа рЃЏрЃЮрЃўрЃФрЃћрЃЉрЃюрЃљ (рЃерЃћрЃАрЃљрЃФрЃџрЃЮрЃљ, рЃБрЃЎрЃЋрЃћ рЃерЃћрЃАрЃарЃБрЃџрЃЊрЃљ рЃљрЃю рЃњрЃљрЃБрЃЦрЃЏрЃЊрЃљ).

---

## ­ЪњА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў

рЃўрЃ«рЃўрЃџрЃћрЃЌ [task_pool_pattern.md](../convention/task_pool_pattern.md) рЃЊрЃћрЃбрЃљрЃџрЃБрЃарЃў рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃўрЃАрЃЌрЃЋрЃўрЃА.
