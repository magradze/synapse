<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Synapse ESP Framework: 🚀 მოდულების ინიციალიზაციის დონეები (Initialization Levels)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Synapse ESP Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_2convention_2initialization__levels.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">🚀 მოდულების ინიციალიზაციის დონეები (Initialization Levels)</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md924"></a> <b>სტატუსი:</b> მკაცრი რეკომენდაცია (Strongly Recommended) <br  />
 <b>ავტორი:</b> Synapse Framework Team</p>
<h1><a class="anchor" id="autotoc_md925"></a>
🎯 მიზანი</h1>
<p>ეს დოკუმენტი განსაზღვრავს <b>სტანდარტიზებულ სტრატეგიას</b> <code>init_level</code> პარამეტრის გამოყენებისთვის Synapse Framework-ის მოდულებში. <code>init_level</code> არის რიცხვითი მნიშვნელობა, რომელიც განსაზღვრავს, რა თანმიმდევრობით უნდა მოხდეს მოდულების ინიციალიზაცია სისტემის გაშვებისას.</p>
<p><b>სწორი <code>init_level</code>-ების გამოყენება კრიტიკულად მნიშვნელოვანია სისტემის სტაბილურობისთვის</b>, რადგან ის უზრუნველყოფს, რომ მოდული-მომხმარებელი (Consumer) არ შეეცდება გამოიყენოს სერვისი, რომელიც ჯერ არ არის ინიციალიზებული და დარეგისტრირებული მოდული-მომწოდებლის (Provider) მიერ.</p>
<h1><a class="anchor" id="autotoc_md926"></a>
⚙️ როგორ მუშაობს?</h1>
<p><code>System Manager</code> კომპონენტი სისტემის გაშვებისას (<code>fmw_system_start</code>) ყველა რეგისტრირებულ მოდულს ალაგებს <code>init_level</code>-ის <b>ზრდადობის მიხედვით</b> (დაბალიდან მაღლისკენ) და შემდეგ ამ თანმიმდევრობით იძახებს მათ <code>init()</code> ფუნქციებს.</p>
<ul>
<li><b>დაბალი <code>init_level</code></b> = ადრეული ინიციალიზაცია</li>
<li><b>მაღალი <code>init_level</code></b> = გვიანი ინიციალიზაცია</li>
</ul>
<h1><a class="anchor" id="autotoc_md927"></a>
📜 ოქროს წესი</h1>
<blockquote class="doxtable">
<p>&zwj;💡 <b>სერვისის მომწოდებელ (Provider) მოდულს ყოველთვის უნდა ჰქონდეს უფრო დაბალი <code>init_level</code>, ვიდრე სერვისის მომხმარებელ (Consumer) მოდულს.</b> </p>
</blockquote>
<p><b>მაგალითი:</b> <code>rgb_led_indicator</code> მოდული იყენებს <code>command_router</code>-ის სერვისს. შესაბამისად:</p>
<ul>
<li><code>command_router.init_level</code> (მაგ: <code>50</code>) **&lt;** <code>rgb_led_indicator.init_level</code> (მაგ: <code>60</code>)</li>
</ul>
<h2><a class="anchor" id="autotoc_md928"></a>
💡 პრაქტიკული მაგალითი: &lt;tt&gt;wifi_manager&lt;/tt&gt; და &lt;tt&gt;command_router&lt;/tt&gt;</h2>
<ul>
<li><b>პრობლემა:</b> <code>wifi_manager</code>-ს სჭირდება CLI ბრძანებების დარეგისტრირება, რისთვისაც ის იყენებს <code>command_router</code>-ის სერვისს. თუმცა, <code>wifi_manager</code> (<code>init_level: 40</code>) ინიციალიზდება უფრო ადრე, ვიდრე <code>command_router</code> (<code>init_level: 50</code>).</li>
<li><b>გამოსავალი:</b> <code>wifi_manager</code> თავის <code>init</code> ფუნქციაში არ ცდილობს ბრძანების რეგისტრაციას. ამის ნაცვლად, ის გამოიწერს <code>FMW_EVENT_SYSTEM_START_COMPLETE</code> ივენთზე. როდესაც <code>System Manager</code>-ი დაასრულებს ყველა მოდულის გაშვებას და გამოაქვეყნებს ამ ივენთს, <code>wifi_manager</code>-ის <code>handle_event</code> ფუნქცია იღებს მას და მხოლოდ ამის შემდეგ არეგისტრირებს თავის CLI ბრძანებებს. ამ დროისთვის, <code>command_router</code>-ის სერვისი გარანტირებულად ხელმისაწვდომია.</li>
</ul>
<p>ეს მაგალითი ნათლად აჩვენებს, თუ როგორ წყვეტს <code>init_level</code>-ებისა და სისტემური ივენთების კომბინაცია რთულ დამოკიდებულების პრობლემებს.</p>
<h1><a class="anchor" id="autotoc_md929"></a>
📊 ინიციალიზაციის დონეების რეკომენდებული დიაპაზონები</h1>
<p>იმისათვის, რომ შევინარჩუნოთ წესრიგი და თავიდან ავიცილოთ კონფლიქტები, გთავაზობთ <code>init_level</code>-ების შემდეგ სტრუქტურას. ახალი მოდულის დამატებისას, შეარჩიეთ შესაბამისი დიაპაზონი მისი როლიდან გამომდინარე.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md931"></a>
📦 &lt;strong&gt;დონე 1: ფუნდამენტური დრაივერები და რესურსები (0-19)&lt;/strong&gt;</h2>
<p>ესენი არიან ყველაზე დაბალი დონის მოდულები, რომლებზეც შეიძლება დამოკიდებული იყოს თითქმის ყველა სხვა მოდული. ისინი, როგორც წესი, არ იყენებენ სხვა მოდულების სერვისებს.</p>
<ul>
<li>**<code>init_level: 0-9</code>**<ul>
<li>💧 **<code>resource_manager</code>**: უნდა იყოს ერთ-ერთი პირველი, რადგან სხვა დრაივერებმა შეიძლება დაიკავონ რესურსები.</li>
</ul>
</li>
<li>**<code>init_level: 10-19</code>**<ul>
<li>🚌 **<code>i2c_bus_module</code>, <code>spi_bus_module</code>**: აპარატურული ავტობუსების დრაივერები.</li>
<li>🔌 **<code>gpio_manager</code>** (თუ არსებობს).</li>
</ul>
</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md933"></a>
🛠️ &lt;strong&gt;დონე 2: საბაზისო სისტემური სერვისები (20-39)&lt;/strong&gt;</h2>
<p>ეს მოდულები უზრუნველყოფენ ფონურ, სისტემურ სერვისებს. ისინი შეიძლება დამოკიდებული იყვნენ 1-ლი დონის დრაივერებზე.</p>
<ul>
<li>**<code>init_level: 20-29</code>**<ul>
<li>💾 **<code>storage_manager</code> / <code>nvs_module</code>**: მეხსიერებასთან მუშაობა.</li>
<li>📝 **<code>logger_module</code>**: ლოგირების სერვისი.</li>
</ul>
</li>
<li>**<code>init_level: 30-39</code>**<ul>
<li>❤️ **<code>health_monitor</code>**: სისტემის ჯანმრთელობის მონიტორინგი.</li>
<li>🐶 **<code>watchdog_manager</code>**: Watchdog-ის მართვა.</li>
</ul>
</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md935"></a>
📡 &lt;strong&gt;დონე 3: ქსელი, კონტროლი და კომუნიკაცია (40-59)&lt;/strong&gt;</h2>
<p>ეს არის ძირითადი საკომუნიკაციო და მართვის მოდულები, რომლებიც ხშირად წარმოადგენენ სერვისების მომწოდებლებს აპლიკაციის დონის მოდულებისთვის.</p>
<ul>
<li>**<code>init_level: 40-49</code>**<ul>
<li>📶 **<code>wifi_manager</code>**: WiFi კავშირის მართვა.</li>
<li>⏱️ **<code>time_sync_module</code>**: დროის სინქრონიზაცია.</li>
</ul>
</li>
<li>**<code>init_level: 50-59</code>**<ul>
<li>⌨️ **<code>command_router</code>**: ბრძანებების ცენტრალიზებული მართვა. (კარგი საწყისი წერტილი: <code>50</code>)</li>
<li>☁️ **<code>mqtt_module</code>**: MQTT ბროკერთან კავშირი.</li>
<li>🔄 **<code>ota_update_manager</code>**: Over-the-Air განახლებები.</li>
<li>🌐 **<code>http_server_module</code>**: ლოკალური ვებ-სერვერი.</li>
</ul>
</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md937"></a>
💡 &lt;strong&gt;დონე 4: აპლიკაციის ლოგიკა და პერიფერია (60-79)&lt;/strong&gt;</h2>
<p>ეს არის მოდულების ყველაზე გავრცელებული დონე. ისინი, როგორც წესი, არიან 1-3 დონის სერვისების <b>მომხმარებლები (Consumers)</b>.</p>
<ul>
<li>**<code>init_level: 60-69</code>**<ul>
<li>🌡️ <b>სენსორების მოდულები</b> (<code>dht22_module</code>, <code>bme280_module</code> და ა.შ.): იყენებენ I2C/SPI დრაივერებს.</li>
<li>💡 <b>აქტუატორების მოდულები</b> (<code>relay_module</code>, <code>motor_driver</code> და ა.შ.): იყენებენ <code>resource_manager</code>-ს.</li>
</ul>
</li>
<li>**<code>init_level: 70-79</code>**<ul>
<li>🎨 **<code>rgb_led_indicator</code>**: იყენებს <code>command_router</code>-ს, <code>resource_manager</code>-ს და რეაგირებს <code>wifi_manager</code>-ის ივენთებზე. (კარგი საწყისი წერტილი: <code>70</code>)</li>
<li>📺 <b>დისპლეის მოდულები</b> (<code>ssd1306_module</code>): იყენებენ I2C/SPI დრაივერებს.</li>
</ul>
</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md939"></a>
🧩 &lt;strong&gt;დონე 5: მაღალი დონის კომპოზიტური მოდულები (80-100)&lt;/strong&gt;</h2>
<p>ეს მოდულები შეიძლება დამოკიდებული იყვნენ მე-4 დონის მოდულების სერვისებზე.</p>
<ul>
<li>**<code>init_level: 80-89</code>**<ul>
<li>🤖 **<code>automation_engine</code>**: მოდული, რომელიც კითხულობს სენსორის მონაცემებს (დონე 4) და მართავს რელეს (დონე 4).</li>
</ul>
</li>
<li>**<code>init_level: 90-100</code>**<ul>
<li>📱 **<code>ble_provisioning</code>**: მოდული, რომელიც შეიძლება საჭიროებდეს WiFi-ს, სერვისების და სხვა კომპონენტების მართვას.</li>
</ul>
</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md941"></a>
📝 როგორ განვსაზღვროთ &lt;tt&gt;init_level&lt;/tt&gt; ახალი მოდულისთვის?</h1>
<ol type="1">
<li><b>დაადგინეთ დამოკიდებულებები:</b> რომელ სხვა მოდულების <b>სერვისებს</b> იყენებს თქვენი ახალი მოდული?</li>
<li><b>იპოვეთ მომწოდებლების <code>init_level</code>-ები:</b> შეამოწმეთ იმ მოდულების <code>module.json</code> ფაილები, რომლებზეც ხართ დამოკიდებული.</li>
<li><b>აირჩიეთ უფრო მაღალი <code>init_level</code>:</b> თქვენი მოდულის <code>init_level</code> უნდა იყოს ყველა იმ მოდულის <code>init_level</code>-ზე მაღალი, რომლის სერვისსაც იყენებთ.</li>
<li><b>დატოვეთ "სივრცე":</b> ნუ აირჩევთ პირდაპირ მომდევნო რიცხვს (მაგ., 50-ის შემდეგ 51). დატოვეთ 5-10 ერთეულიანი შუალედი, რათა მომავალში სხვა მოდულების ჩამატება გამარტივდეს.</li>
<li><b>განაახლეთ <code>module.json</code>:</b> ჩაწერეთ არჩეული <code>init_level</code> თქვენი მოდულის <code>module.json</code> ფაილში.</li>
</ol>
<p>ამ სტრუქტურის დაცვა უზრუნველყოფს, რომ Synapse Framework-ის ეკოსისტემა დარჩეს ორგანიზებული, პროგნოზირებადი და მარტივად გასაფართოებელი. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
